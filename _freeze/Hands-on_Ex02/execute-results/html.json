{
  "hash": "d55dab19afd818c27fb31f6a252a3157",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Working with GIS Data\"\ndate: \"10/30/2022\"\ndate-modified: \"last-modified\"\nformat:\n  html:\n    theme: materia\n    fontsize: 1.2em\n    toc-font-size: 0.8em\nexecute: \n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n\n\n\n\n\n\nA GIS is specially designed to manage geospatial data. This hands-on exercise consists of five sections. First, you will learn how to import geospatial data from different sources and file format into QGIS. At the same time, you will also learn how to check their feature type, coordinate system and other related information. You will also learn how to create a GIS data from an aspatial data by using QGIS. Next, you will learn how to transform this newly created GIS layer into Singapore National projected coordinates systems (i.e. SVY21). Lastly, you will also learn how to use the geocoding function of QGIS to create geospatially referenced data from a non-spatial data.\n\n## Learning Outcome\n\nBy the end of this session, you will be able to:\n\n-   work with geospatial data from data.gov.sg\n-   create geospatially-enabled data\n-   create GIS Layer from a text data with georeference information\n-   transform a GIS data onto a different projection system\n-   work with raster GIS data\n-   work with internet geospatial services\n-   work with geospatial database\n\n## Working with Geospatial Data from data.gov.sg\n\nIn this section, you will learn how to download geospatial data from data.gov.sg and import them into QGIS.\n\n### Downloading geospatial data from data.gov.sg\n\nFirst, you are required to download the following geospatial and aspatial data from [data.gov.sg](https://data.gov.sg/):\n\n-   Master Plan 2014 Subzone Boundary (No Sea),\n-   Child Care Services,\n-   Street and Places, and\n-   General information of schools from School Directory and Information.\n\n### Managing the imported data\n\nFor any GIS project, it is important for us to practice good document management. Assuming that the root directory of this project is called `Hands-on_Ex02`,\n\n-   created a sub-folder call `data.gov`.\\\n-   inside `data.gov`, create two new sub-folders. Call them `geospatial` and `aspatial` respectively.\n-   place the downloaded Master Plan 2014 Subzone Boundary (No Sea), Child Care Services and Street and Places into the geospatial folder.\n    -   unzipped their respective zipped files,\n    -   extract the unzipped files, and\n    -   place them in `geospatial` folder.\n-   place the downloaded `Generalinformationofschools.csv` into `aspatial` sub-folder.\n\nThe geospatial folder should look similar to the screenshot below.\n\n![](img02/image1.jpg)\n\n### Examining the geospatial data\n\nBefore you add the GIS data into QGIS, you should spend some time to examine the files in `geospatial` folder.\n\nNotice that the shapefile version of MP14_SUBZONE_NO_SEA_PL and StreetsandPlaces data sets are actually made up of multiples files that have the same names but with different extensions.\n\nTable below details the meaning of each file. ![](img02/image2.jpg) Source: https://en.wikipedia.org/wiki/Shapefile\n\nNext, you should also check the projection of the shapefile.\n\n-   Right-click on the PRJ file of `MP14_SUBZONE_NO_SEA_PL`\n-   Select *Open with* -\\> *NotePad*.\n\nYour NotePad should look similar to the figure below.\n\n![](img02/image3.jpg)\n\nFrom the screenshot, it is clear that `MP14_SUBZONE_NO_SEA_PL` is in svy21 projected coordinate system.\n\n-   Close the NotePad.\n\nDifferent from shapefile, the geojson and kml files are editing in xml format. You can examine the content of these two files by using either Notepad or WordPad.\n\n### Adding geospatial data from data.gov into QGIS\n\nNow, we are ready to bring the geospatial data downloaded from data.giv.sg into QGIS.\n\n-   From Window Desktop, launch QGIS.\n\nYou will start a new QGIS project.\n\n-   From the menu bar, select **Project** -\\> **New**.\n\nNext, you are going to learn how to bring geospatial data sets into QGIS via the **Browser** panel.\n\n-   From the Browser panel, navigate to the path of `Hands-on_Ex02\\geospatial` as shown in the screenshot below.\n\n![](img02/image4.jpg){width=\"450\"}\n\n-   Double-click on `ChildCareServices.geojson`.\n\nNotice that `ChildCareServices.geojson` is added in the **Layer** panel and display on the View window as shown below.\n\n![](img02/image5.jpg)\n\n> DIY: Using the steps you had learned, bring in `MP14_SUBZONE_NO_SEA_PL.shp` and `StreetsandPlaces.shp` into QGIS.\n\nYour screen should look similar to the figure below.\n\n![](img02/image6.jpg)\n\nNotice that `ChildCareServices` layers does not appear on Map View. This is because it is covered by `MP14_SUBZONE_NO_SEA_PL` layer.\n\n-   From the **Layer** panel, click on `MP14_SUBZONE_NO_SEA_PL` layer.\n-   Hold down the left mouse button, drag and place it below `ChildCareServices`.\n\nNow you should see all the active layers appear on the View window as shown below.\n\n![](img02/image7.jpg)\n\n> QGIS Tip: In order to avoid point and line feature layers being blocked away by polygon feature layer, it is always advisible to place the polygon feature layer at the botton of the layer order.\n\nIt is time to save the project.\n\n-   From the menu bar, click **Project** -\\> **Save** (Alternatively, from the icon bar, click on **Save Project** icon).\n-   At the **Choose a QGIS project file** dialog window, navigate to the root project folder, then provide a proper project name such as `Hands-on_Ex02`, remember to select *QGIS files (*.qgs)\\* from the **Save as type:** dropdown list.\n\nYour screen should look similar to the figure below.\n\n![](img02/image8.jpg)\n\n-   click on **Save** button.\n\nNotice that the upper left corner of the top banner is labelled `Hands-on_Ex02` instead of `untitled` now.\n\n## Working with Projection\n\nIn this section, you will learn how to:\n\n-   assign appropriate coordinate system to the QGIS project.\n-   how to transform a GIS data set from one coordinate system to another coordinate system.\n\n### Assigning project coordinate system\n\nIf you refer to the lower left corner of the active QGIS project window, there is a high chance that the EPSG is not in **3414** which is the EPSG code of **svy21**.\n\nIf there is the case, you can use the step below to assign the correct projection system for your QGIS project.\n\n![](img02/image9.jpg)\n\n-   At the lower right corner of QGIS project banner, click on the list of **Render**.\n\nProject Properties dialog window appears.\n\n![](img02/image10.jpg)\n\n-   From **Predefined Coordinate Reference Systems**, click on **EPSG:3414** from the list.\n-   Click on **Apply** button to make the change.\n-   Click on **OK** button to close the window.\n\nNotice that the projection has been updated to EPSG:3414 now.\n\n![](img02/image11.jpg)\n\nOption:\n\nIf this is the first time you use the **Projection Properties**, there is a high chance that the **Predefined Coordinate Reference Systems** is empty.\n\nIn this case,\n\n-   at **Filter**, type **3414**. This will help to narrow down the search.\n\nBefore you move on to the next section, you should save the latest changes on the project file.\n\n-   From the icon bar, click on the **Save Project** icon.\n\n### Transforming coordinate system\n\nIn a GIS project, it is always a good practice to keep the geospatial data set(s) in a same projected coordinate system, using the national projected coordinate system such as svy21 of Singapore.\n\nIn this section, you will learn how to transform a geospatial data set from WGS84 Geographic Coordinate System to SVY21 Projected Coordinates System. You will also learn how to save the output into a new shapefile for permanent storage purpose. For the purpose of this exercise, `ChildCareServices` layer will be used.\n\nFirst, let us verify if an appropriate projection system was used.\n\n-   From the **Layers** panel, right-click on `ChildCareServices` layer.\n-   Select **Properties**.\n\nThe Layer Properties dialog window of `ChildCareServices` layer appears.\n\n![](img02/image12.jpg)\n\n-   Click on **Source**.\n\nNotice that `ChildCareServices` layer is in WGS geographic coordinates system and not in SVY21 projected coordinates system.\n\n-   Click on **OK** button to close the dialog window.\n\nNext, we are going export the `ChildCareServices` layer into a new shapefile and at the same time transform the newly created shapefile into svy21 projected coordinates systems.\n\n-   From the **Layers** panel, right-click on `ChildCareServices` layer.\n-   Select **Export** -\\> **Save Features As** from the context menu.\n\nThe **Save Vector Layer** dialog window appears.\n\n-   For **Format:**, select **ESRI Shapefile** from the drop-down list.\n-   For **Save as**, click on the *Browse* button.\n\nThe **Save Layer As** dialog window appear.\n\n-   Navigate to `\\SMT201\\Hands-On02\\geospatial\\` sub-folder.\n-   For File Name, type `ChildCareServices`.\n\n![](img02/image13.jpg)\n\n-   Click on the **Save** button.\n\nYou will return to **Save Vector Layer as** dialog window.\n\nNow, you are going to select the appropriate projected coordinate system.\n\n-   For **CRS**, click on the **Browse** button.\n\nThe Coordinate Reference System Selector dialog window appears.\n\n-   Click on SVY21/Singapore TM.\n-   Click on OK to update the selection.\n\n![](img02/image14.jpg)\n\nNotice that the **CRS** is **EPSG:3414 - SVY21 / SINGAPORE TM** now.\n\nKeep the rest of the default option check and you are ready to convert the geospatial data set into ESRI shapefile format and at the same time transform it into SVY21 projected coordinate system.\n\n-   Click on the **OK** button.\n\nNotice that a new geospatial layer called `ChildcareServices` has been added on `Layers` panel and was plotted on the View window.\n\n> DIY: Using the steps you had learned in earlier section, check the properties of of this newly created `ChildcareServices`\n\n![](img02/image15.jpg)\n\nYou screen should look similar to the screensht above.\n\nNotice that `ChildCareServices` layer is in ESRI Shapefile format and its Coordinate Reference System in SVY21 / SINGAPORE TM.\n\n-   Click on OK button to close the dialog window.\n\n> DIY: You can also remove `ChildCareServices` layer from Layers dialog window.\n\n## Creating Geospatially-Enabled Data\n\nBy and large, business data such as polyclinics, schools and business establishments do not capture geospatial information such as x- and y- coordinates explicitly. However, it is possible to create geospatially-enabled data from them by using the geocoding technique.\n\nGeocoding is the process of finding associated geographic coordinates (often expressed as latitude and longitude) from other geographic data, such as street addresses, zip codes or postal codes (http://en.wikipedia.org/wiki/Geocoding).\n\n### Data Preparation\n\nIn this section, you will learn how to create geospatially enable data by using `Generalinformationofschools.csv` you downloaded from data.gov.sg.\n\nNote: In this section, we assume that `Generalinformationofschools.csv` is stored in `\\Hands-on_Ex02\\aspatial\\` sub-folder and you have Microsoft Excel installed in your computer.\n\nLet us review the content of `Generalinformationofschools.csv` file.\n\n-   At File Explorer, navigate to the sub-folder where `Generalinformationofschools.csv` is stored.\n-   Right-click on `Generalinformationofschools.csv` file.\n-   From the context menu, select **Open with** -\\> **Excel**.\n\nYour screen should look similar to the figure below.\n\n![](img02/image16.jpg)\n\nNotice that `Generalinformationofschools.csv` file consists of 31 fields. However, we only need to retain `school_name`, `address` and `postal_code` field.\n\n-   Use appropriate Excel function to delete the unwanted fields.\n\nNext, we will create two new fields. They are: `country` and `city`.\n\n-   Use appropriate Excel function to create two new fields. Call them `country` and `city`.\n-   Fill in the cell below `country` and `city` fields with `Singapore`.\n\nThe final `Generalinformationofschools.csv` should look similar to the screenshot below.\n\n![](img02/image17.jpg)\n\n-   Use the *Save as* function of Excel to save the tidied csv file into Hands-on_Ex02\\data\\data.gov\\aspatial sub-folder. Name the output file `schools.csv`.\n\n> Note: It is important to ensure that the output file is in csv file format.\n\n### Install the MMQGIS Plugin\n\nInstead of using the geocoding API of SLA OneMap, in this section you will use the *Geocode Tools* of [**MMQGIS**](http://michaelminn.com/linux/mmqgis/) plugin developed by Michael Minn.\n\nTo install the **MMQGIS** plugin, you will need to load the QGIS plugin repository by following the steps below.\n\n-   From the menu bar, select **Plugins** --\\> **Manage and Install Plugins**.\n\nPlugins dialog window appears as shown below.\n\n![](img02/image18.jpg)\n\nNotice that there is a long list of plugins available. We can use the Search function to locate mmqgis plugin easily.\n\n-   At Search, type *mmqgis*.\n\nYour screen should look similar to the figure below.\n\n![](img02/image19.jpg)\n\n> **Friendly Advice:** It is a good practice to read the documentation of the plugin (i.e. More info: homepage) thoroughly before download or/and using any QGIS plugin.\n\n-   Click on **Install Plugin** button to run the installer.\n\nAfter installing mmqgis plugin, remember to close the Plugin dialog window.\n\n-   Click on **Close** button.\n\n### Geocoding using MMQGIS Plugin\n\nNow, you are ready geocode `schools` dataset.\n\n-   From the menu bar, select **MMQGIS** -\\> **Geocode** -\\> **Geocode CSV with Web Service**.\n\nWeb Service Geocode dialog window appears.\n\n![](img02/image20.jpg)\n\nGeocode Tools of MMQGIS plugin imports addresses from a CSV file. The input CSV file should be encoded in the UTF-8 character set. Although other 8-bit encodings (like Windoze ISO-8859-x) will work if only ASCII characters are present, non-ASCII characters may cause unpredictable behavior.\n\n-   From **Input CSV File (UTF-8)**, click on **Browse** button.\n\n**Select a file** dialog window appears.\n\n-   Navigate to the path where `schools.csv` reside.\n-   Click on `schools.csv`.\n-   Click on **Open** button.\n\nYour screen should similar to the screenshot below.\n\n![](img02/image21.jpg)\n\nNotice that the **Address**, **City** and **Country** drop-down lists have been mapped to the corresponding field names in `schools.csv`. This explains why the data preparation performed in previous step was important and necessary.\n\n**MMQGIS Geocode Tool** supports five geocoding services. They are: Google, OpenStreetMap/Nomination, US Census Bureau, ESRI Server and NetToolKit. Except OpenStreetMap/Nomination, the rest of the geocoding services required you to have an API key.\n\nIn this exercise, OpenStreetmap/Nominatim geocoding service will be used.\n\n> Warning: To complete this section, you will need internet access to run the geocoding process.\n\n-   For *Web Service*, select **OpenStreetMap/Nominatim** from the drop-down list.\n\nGeocode Tool will generate two output files. They are a point feature GIS data set along with a *Not Found CSV* file containing all rows that could not be geocoded (for whatever reason). We need to tell Geocode Tool where to keep these two output files.\n\n-   Use File Explorer to create a new sub-folder called `geocoding` in `Hands-on_Ex02` directory.\n-   For **Output File Name**, click on **Browse** button.\n\n**Create or select a file** dialog window appears.\n\n-   Navigate to the newly create `geocoding` sub-folder.\n-   For **File name**, type `geocoded_sch.shp`.\n-   Click on **Save** button.\n\nYou also need to provide the **Not Found List Output list** a place holder.\n\n-   For **Not Found Output list**, click on **Browse** button.\n\n**Create or select a file** dialog window appears.\n\n-   Navigate to the newly create *geocoding* sub-folder.\n-   For **File name**, type `not_found_sch.csv`.\n-   Click on **Save** button.\n\nThe completed dialog window should look similar to the screenshot below.\n\n![](img02/image22.jpg)\n\nNow, you are ready to perform the geocoding function.\n\n• At the **Web Service Geocode** dialog window, click on **Apply** button.\n\nBe patient, the process will take some time to complete.\n\nWhen the geocoding function is completed, notice that a new shapefile layer will be added on QGIS map window. At the same time, the progress bar will indicate numbers of records that have been geocoded successfully as shown below.\n\n![](img02/image23.jpg)\n\nThe output report shows that out of the 337 schools data records, 336 of them have been geocoded successfully.\n\n-   click on **Close** button to closed the dialog window.\n\nLet us examine the layer properties of the newly created `geocoded_sch` layer.\n\n-   Hover your mouse over geocoded_sch layer, right-click and select **Open Attribute Table** from the context menu.\n\nThe **Attribute table** of `geocoded_sch` appears.\n\n![](img02/image24.jpg)\n\nNotice that all columns from the input CSV file are added as attributes in the output shapefile. Six additional fields are added to in the shapefile. The **category** and **type** fields are internal from OpenStreetMap. They provide useful data classification for the schools data sets.\n\n> DIY: Using the steps your had learned in previous section, examine and transform the coordinate system of `geocoded_sch` data set into SVY21 projected coordinate system.\n\n## Working with Raster GIS data\n\nRaster data such as those collected by remote sensing satellite or airplanes are one of the important data sources of a GIS project. By and large, these data are stored in image file format such as TIF, GeoTIF, JPG and GeoJPG. In this section, you will learn how to bring a raster data in GeoTIF file format into QGIS. The raster data is called Chinatown.tif. It is available in `Hands-on_Ex02\\RasterData` sub-folder.\n\n-   Start **File Explorer**.\n-   Navigate to `Hands-on_Ex02\\data\\RasterData` sub-folder.\n\nYou should see the following files in the sub-folders.\n\n![](img02/image25.jpg)\n\nThis is an example of images file in GeoTIF format. The geographical information of the image file (i.e. Chinatown.TIF) is actually contained in the Chinatown.XML file.\n\n-   Open `Chinatown.XML` using **Notepad**.\n\nIt should look similar to the figure below.\n\n![](img02/image26.jpg)\n\nIt provides details information of the image file including georeference system used, the geographical extent of the data, spectral resolution of the dataset and spatial resolution of the dataset.\n\nNext, you will important Chinatown raster data into QGIS.\n\n-   From **Browser** panel, navigate to sub-folder as shown in the screenshot below.\n\n![](img02/image27.jpg){width=\"350\"}\n\n-   Double-click on `Chinatown.tif`.\n\nNotice that a new raster layer called Chinatown has been added on the **Layers** panel. However, it is not visible on the View window. This is because it is block by the massive point features.\n\nIn order to view the newly added `Chinatown` layer, we need to zoom into the extend of `Chinatown` layer.\n\n> DIY: Using the steps you had learned in Hands-on Exercise 1, zoom to the extend of `Chinatown` layer.\n\nYour screen should look similar to the screenshot below.\n\n![](img02/image28.jpg)\n\n> DIY: Using the steps you had learn in the earlier sections of this hands-on exercise, examine the properties of `Chinatown` data layer.\n\n## Working with Internet Geospatial Services\n\nOne of the unique feathers of a modern GIS is its capability of consuming GIS data shared over the internet. These data can be in the form of WMS, WMS or proprietary format such as Google map, Bing map and OpenStreetMap format. In this section, you will learn how to consume an OpenStreetMap (OSM) data using QGIS.\n\nDIY: Before we can use OSM service, let us display the map view by using the full extent of `MP14_SUBZONE_NO_SEA_PL` layer. This is because we will use the extend of `MP14_SUBZONE_NO_SEA_PL` as the reference to map OSM service in QGIS.\n\n-   From **Browser** panel, click on the triangle in front of **XYZ Tiles**.\n\nOpenStreetMap icon appears as shown in the screenshot below.\n\n![](img02/image29.jpg){width=\"350\"}\n\n-   Double-click on **OpenStreetMap** icon.\n\nYour screen should look similar to the figure below.\n\n![](img02/image30.jpg)\n\n> DIY: Use the skills you had learned from previous sections, 1. Re-organise the GIS layers so that you can see schools, street and places and childcare centres are plotted on top of OpenStreetMap layer. 2. Navigate around the map areas and look for details.\n\n\n\n\n\n\n\n\n::: {.cell}\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}