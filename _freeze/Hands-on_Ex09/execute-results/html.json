{
  "hash": "dec0a840c958de336767fa9338ac31b9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Shortest Path Analysis: QGIS methods\"\ndate: \"10/30/2022\"\ndate-modified: \"last-modified\"\nformat:\n  html:\n    theme: materia\n    fontsize: 1.2em\n    toc-font-size: 0.8em\nexecute: \n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n\n\n\n\n\n\nCalculating the shortest distance between two points is a very common spatial problem that appears in our daily life quite often. In this hands-on exercise, you will learn how to use QGIS tool as a solution for finding the shortest path distance or time by calculating cumulative cost between two points in a network.\n\nBy the end of this hands-on exercise, you will be able to:\n\n-   extract, clean and process network data from roads layer of OSM data, and\n-   performing shortest path analysis using QGIS build in network analysis tools\n\n## Setting the scene\n\n### The Task\n\nIn this hands-on exercise, you are tasked to derive an accessibility to eldercare centre map of Singapore.\n\n### The Data\n\nThree major data sets will be used in this hands-on exercise. They are:\n\n-   Master Plan 2019 Subzone Boundary from URA. This data can be downloaded from data.gov.sg.\n-   Eldercare services from Ministry of Social and Family Development. This data can be downloaded from data.gov.sg.\n-   Roads data from OpenStreetMap (OSM) data sets. OSM data sets can be downloaded from Geofabrik's free download [server](https://download.geofabrik.de/).\n\n**Note:** I recommend this download site instead of [bbbike](https://www.bbbike.org/) because I found out that the quality of the data provided by Geofabrik is better than bbbike.\n\n## Data Preparation\n\n### Start a new QGIS Project\n\n> DIY: Using the steps you had learned in previous hands-on exercise, start a new QGIS project. Save the project and give it a name (i.e. Hands-on_Ex09).\n\n**Reminder:** Ensure that svy21 projection system is used.\n\n### Preparing base layer for the study area\n\n> DIY: Download Master Plan 2019 Subzone Boundary from data.gov.sg and import it into QGIS. Then, save the GIS layer into GeoPackage format. Name the output layer as `mpsz2019`.\n\n### Preparing eldercare layer\n\n> DIY: Download eldercare services data from data.gov.sg and import it into QGIS (Ideally, the shapefile version should be used). Then, save the GIS layer into GeoPackage format. Name the output layer as `eldercare`.\n\n### Extracting and preparing road network layer\n\n#### Selecting all road network with the study area\n\n> DIY: Using appropriate QGIS function(s) you had learned from previous hands-on exercise, clip the road network with Singapore mainland (excluding outer insland, Pulau Tekong and Pulau Ubi). Save the GIS layer into GeoPackage format. Call the layer `all_roads`.\n\n### Extracting motor vehicle road network\n\n> DIY: Using appropriate QGIS function(s) you had learned from previous hands-on Exercise, extract motor vechicle road network (i.e. motorway, motorway_link, primary, primary_link, secondary, secondary_link, tertiary, tertiary_link, residential, trunk and trunk_link) from the all_roads layer. Save the GIS layer into GeoPackage format. Name the layer `roads`.\n\n**Be warn:** The original data is in **wgs84**. For the purpose of network analysis, all network should be in projected coordinates system.\n\n**Reminder:** Remove all the source data from QGIS project before continue to the next section.\n\n## Shortest Path Analysis\n\nIn this section, you will perform the following tasks:\n\n-   Identifying useful attribute(s) from the `roads` layer by using QGIS Identify Features tool,\n-   Visualising topological properties of `roads` layer by using styling methods of QGIS, and\n-   Determining shortest path from a demand point (ie. HDB block) to a supply point (i.e. eldercare centre).\n\n### Working with Identify Features tool\n\nIn this section, you will explore the attribute information of `road` layer by using QGIS.\n\n> DIY: Zoom to Punggol area as shown in the screenshot below.\n\n![](img09/image6.jpg)\n\n-   Switch off all other layers except `roads` and `eldercare`.\n\n-   At **Layers** panel, click on `roads` layer to make it active.\n\n-   From the menu bar, click on **Identify Features** icon.\n\n-   Hover the mouse over a road segment and click on it.\n\nThe **Identify Results** dialog window appears.\n\nYour screen should look similar to the screenshot below.\n\n![](img09/image7.jpg)\n\nThere are many information can be derived from the dialog window. For the time being, let us focus on *oneway* field. It specifies whether the road segment is two-way or one-way. If it is one-way, the flow direction will be given.\n\nThere are three different values. *B* for two-way. *F* means that only driving in direction of the line string is allowed. *T* means that only the opposite direction is allowed.\n\n-   Close the Identify Results dialog window.\n\n### Working with QGIS's Styling methods\n\nNow, we will use the information in oneway field to display an arrow on one-way streets\n\n-   From the **Layers** panel, click on **Open the Layer Styling Panel** button.\n\nThe **Layer Styling** panel appears on the right as shown below.\n\n![](img09/image8.jpg)\n\n-   Select *Rule-based* from the drop-down menu.\n\n![](img09/image9.jpg){width=\"45%\"}\n\nWe will create a new style with a filter for only the one-way roads.\n\n-   Click on the *Add rule +* button.\n\n![](img09/image10.jpg){width=\"45%\"}\n\n-   From the **Edit rule** dialog, click on **Expression** button.\n\n![](img09/image11.jpg){width=\"45%\"}\n\nThe **Expression String Builder** dialog window appears.\n\nWe are going to build an expression that select all one-way streets.\n\n-   Click on the black triangle in front of **Fields and Values** to expand the section.\n\n![](img09/image12.jpg){width=\"55%\"}\n\n-   Double-click on `oneway` field.\n\n-   Click on *=* button.\n\n-   At the **Expression** pane, complete the expression as shown below.\n\n![](img09/image13.jpg){width=\"35%\"}\n\n-   Click on **Ok** button.\n\nNotice that **Filter** option has been updated.\n\n![](img09/image14.jpg){width=\"55%\"}\n\nNext, we are going to change the Symbol layer type to *Market line*.\n\n![](img09/image15.jpg){width=\"55%\"}\n\nNotice that the road lines are marked with red markers now.\n\n![](img09/image16.jpg)\n\n-   At the **Marker placement** pane, click on the radio button in front of `on center point`.\n\nNotice that the markers are placed at the centre of each line segment.\n\n![](img09/image18.jpg)\n\n-   At the **Symbol** pane, click on `Simple marker`.\n\n![](img09/image19.jpg){width=\"55%\"}\n\n-   Scroll down and select *filled_arrowhead* marker.\n\n![](img09/image20.jpg){width=\"35%\"}\n\nNotice that arrow-like symbol now appears on the one-way streets as shown below.\n\n![](img09/image21.jpg)\n\nYou can close **Layer Styling** dialog window now.\n\n-   At the **Layer Styling** panel, click on the cross located at the upper right of the panel.\n\n### Working with build in shortest path tool\n\nNow, we are going to determine the shortest path from Block 619B to eldercare centre located at Block 211B (lower left corner of the view window)\n\n-   From the menu bar, click on **Processing** -\\> **Toolbar**.\n\n-   At the **Toolbox** search pane, type **Shortest path**.\n\nYour screen should look similar to the screenshot below.\n\n![](img09/image22.jpg){width=\"45%\"}\n\n-   Double-click on **Shortest path (point to point)** of **Network analysis**.\n\n**Shortest Path (Point to Point)** dialog window appears.\n\n-   For **Vector layer representing network**, select `roads` from the drop-down list.\n\n-   For **Path type to calculate**, select *Shortest* from the drop-down list.\n\n-   For **Start point**, manually click on the *Block 619B*.\n\n-   For **End point**, manually click on *Block 211B*.\n\n-   For **Direction field \\[optional\\]**, select `oneway` from the drop-down list.\n\n-   For **Value for forward direction \\[optional\\]**, type *F*.\n\n-   For **Value for backward direction \\[optional\\]**, type *T*.\n\nThe **Shortest Path (Point to Point)** dialog window looks similar to the screenshot below.\n\n![](img09/image23.jpg)\n\nWe will keep the rest of the selection as default for the time being.\n\nWhen you are ready,\n\n-   click on **Run** button.\n\n**Reminder**: Read the log before closing the dialog window.\n\n-   Click on the **Close** button to close the dialog window.\n\nNotice that a temporary layer called `Shortest Path` is added on Layers panel and is display on the map view.\n\nThe default line thickness of `Shortest Path` is too thin to view.\n\n> DIY: Using the steps you had learned in previous hands-on exercise, increase the thickness of the line symbol.\n\nYou screen should look similar to the screenshot below.\n\n![](img09/image24.jpg)\n\n> DIY: Using the steps you had learned from previous hands-on exercise, save the temporary Shortest Path layer into GeoPackage format. Name the layer `Shortest_path` and add it onto the map view.\n\n> DIY: Remove the temparory layer from the Layers panel.\n\n\n\n\n\n\n\n\n::: {.cell}\n\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}