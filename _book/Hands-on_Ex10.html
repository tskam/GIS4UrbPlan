<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-10-30">

<title>11&nbsp; Geography of Accessibility: QGIS methods â€“ GIS for Urban Planning: QGIS methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Hands-on_Ex11.html" rel="next">
<link href="./Hands-on_Ex09.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Hands-on_Ex10.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Geography of Accessibility: QGIS methods</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">GIS for Urban Planning: QGIS methods</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">First Date with QGIS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Working with GIS Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">GIS Mapping and Geovisualisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Beyond Mapping: Vector-based GIS Analysis for Urban Applications</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Trade Area Analysis with Vector-based GIS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Cartographic Modelling with Raster-based GIS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">GIS Modelling for Urban Land Suitability Study</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">GIS-based Multicriteria Decision Analysis (MCDA) for Land Suitability Study</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Shortest Path Analysis: QGIS methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex10.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Geography of Accessibility: QGIS methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Delineating Service Area Using Network Distance Approach</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Building GeoWeb Mapping Application using QGIS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setting-the-scene" id="toc-setting-the-scene" class="nav-link active" data-scroll-target="#setting-the-scene"><span class="header-section-number">11.1</span> Setting the scene</a>
  <ul class="collapse">
  <li><a href="#the-task" id="toc-the-task" class="nav-link" data-scroll-target="#the-task"><span class="header-section-number">11.1.1</span> The Task</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data"><span class="header-section-number">11.1.2</span> The Data</a></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">11.2</span> Data Preparation</a>
  <ul class="collapse">
  <li><a href="#start-a-new-qgis-project" id="toc-start-a-new-qgis-project" class="nav-link" data-scroll-target="#start-a-new-qgis-project"><span class="header-section-number">11.2.1</span> Start a new QGIS Project</a></li>
  <li><a href="#preparing-base-layer-for-the-study-area" id="toc-preparing-base-layer-for-the-study-area" class="nav-link" data-scroll-target="#preparing-base-layer-for-the-study-area"><span class="header-section-number">11.2.2</span> Preparing base layer for the study area</a></li>
  <li><a href="#preparing-eldercare-layer" id="toc-preparing-eldercare-layer" class="nav-link" data-scroll-target="#preparing-eldercare-layer"><span class="header-section-number">11.2.3</span> Preparing eldercare layer</a></li>
  <li><a href="#extracting-and-preparing-road-network-layer" id="toc-extracting-and-preparing-road-network-layer" class="nav-link" data-scroll-target="#extracting-and-preparing-road-network-layer"><span class="header-section-number">11.2.4</span> Extracting and preparing road network layer</a></li>
  <li><a href="#extracting-motor-vehicle-road-network" id="toc-extracting-motor-vehicle-road-network" class="nav-link" data-scroll-target="#extracting-motor-vehicle-road-network"><span class="header-section-number">11.2.5</span> Extracting motor vehicle road network</a></li>
  </ul></li>
  <li><a href="#analytical-hexagon" id="toc-analytical-hexagon" class="nav-link" data-scroll-target="#analytical-hexagon"><span class="header-section-number">11.3</span> Analytical Hexagon</a>
  <ul class="collapse">
  <li><a href="#creating-hexagon-layer" id="toc-creating-hexagon-layer" class="nav-link" data-scroll-target="#creating-hexagon-layer"><span class="header-section-number">11.3.1</span> Creating hexagon layer</a></li>
  <li><a href="#editing-the-hexagon-layer" id="toc-editing-the-hexagon-layer" class="nav-link" data-scroll-target="#editing-the-hexagon-layer"><span class="header-section-number">11.3.2</span> Editing the hexagon layer</a></li>
  <li><a href="#saving-the-hexagon-layer" id="toc-saving-the-hexagon-layer" class="nav-link" data-scroll-target="#saving-the-hexagon-layer"><span class="header-section-number">11.3.3</span> Saving the hexagon layer</a></li>
  <li><a href="#computing-hexagon-centroid" id="toc-computing-hexagon-centroid" class="nav-link" data-scroll-target="#computing-hexagon-centroid"><span class="header-section-number">11.3.4</span> Computing hexagon centroid</a></li>
  <li><a href="#saving-the-centroid-layer" id="toc-saving-the-centroid-layer" class="nav-link" data-scroll-target="#saving-the-centroid-layer"><span class="header-section-number">11.3.5</span> Saving the centroid layer</a></li>
  </ul></li>
  <li><a href="#network-accessibility-analysis-with-neat3-plugin" id="toc-network-accessibility-analysis-with-neat3-plugin" class="nav-link" data-scroll-target="#network-accessibility-analysis-with-neat3-plugin"><span class="header-section-number">11.4</span> Network Accessibility Analysis with NEAT3 Plugin</a>
  <ul class="collapse">
  <li><a href="#installing-qneat3-plugin." id="toc-installing-qneat3-plugin." class="nav-link" data-scroll-target="#installing-qneat3-plugin."><span class="header-section-number">11.4.1</span> Installing QNEAT3 plugin.</a></li>
  <li><a href="#working-with-od-matrix-tool" id="toc-working-with-od-matrix-tool" class="nav-link" data-scroll-target="#working-with-od-matrix-tool"><span class="header-section-number">11.4.2</span> Working with OD Matrix tool</a></li>
  <li><a href="#extracting-shortest-distance-pairs" id="toc-extracting-shortest-distance-pairs" class="nav-link" data-scroll-target="#extracting-shortest-distance-pairs"><span class="header-section-number">11.4.3</span> Extracting shortest distance pairs</a></li>
  <li><a href="#mapping-accessibility-values" id="toc-mapping-accessibility-values" class="nav-link" data-scroll-target="#mapping-accessibility-values"><span class="header-section-number">11.4.4</span> Mapping Accessibility Values</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Geography of Accessibility: QGIS methods</span></h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 30, 2022</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">January 9, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<p><strong>Accessibility</strong> is the measure of the capacity of a location to be reached from, or to be reached by, different locations. It is a key element in urban planning and management since it is a direct expression of mobility either in terms of people, freight, or information within a city or between cities.</p>
<p>Well-developed and efficient urban transport systems offer high accessibility levels, while less-developed ones have lower levels of accessibility. Thus, accessibility is linked with an array of economic and social opportunities.</p>
<p>All locations are not equal because some are more accessible than others, which implies <strong>inequalities</strong>. Thus, accessibility is a proxy for <strong>spatial inequalities</strong>.</p>
<p>In this hands-on exercise, you will gain hands-on experience on using both build in and plug-in network analysis functions of QGIS to derive accessibility indexes. By the end of this hands-on exercise, you will be able to:</p>
<ul>
<li>derive hexagon layer,</li>
<li>extract, clean and process network data from roads layer of OSM data, and</li>
<li>performing network accessibility by using network analysis tools of QNEAT plug-in.</li>
</ul>
<section id="setting-the-scene" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="setting-the-scene"><span class="header-section-number">11.1</span> Setting the scene</h2>
<section id="the-task" class="level3" data-number="11.1.1">
<h3 data-number="11.1.1" class="anchored" data-anchor-id="the-task"><span class="header-section-number">11.1.1</span> The Task</h3>
<p>In this hands-on exercise, you are tasked to derive an accessibility to eldercare centre map of Singapore.</p>
</section>
<section id="the-data" class="level3" data-number="11.1.2">
<h3 data-number="11.1.2" class="anchored" data-anchor-id="the-data"><span class="header-section-number">11.1.2</span> The Data</h3>
<p>Three major data sets will be used in this hands-on exercise. They are:</p>
<ul>
<li>Master Plan 2014 Subzone Boundary from URA. This data can be downloaded from data.gov.sg.</li>
<li>Eldercare services from Ministry of Social and Family Development. This data can be downloaded from data.gov.sg.</li>
<li>Roads data from OpenStreetMap (OSM) data sets. OSM data sets can be downloaded from Geofabrikâ€™s free download <a href="https://download.geofabrik.de/">server</a>.</li>
</ul>
<p><strong>Note:</strong> I recommend this download site instead of <a href="https://www.bbbike.org/">bbbike</a> because I found out that the quality of the data provided by Geofabrik is better than bbbike.</p>
</section>
</section>
<section id="data-preparation" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="data-preparation"><span class="header-section-number">11.2</span> Data Preparation</h2>
<section id="start-a-new-qgis-project" class="level3" data-number="11.2.1">
<h3 data-number="11.2.1" class="anchored" data-anchor-id="start-a-new-qgis-project"><span class="header-section-number">11.2.1</span> Start a new QGIS Project</h3>
<blockquote class="blockquote">
<p>DIY: Using the steps you had learned in previous hands-on exercise, start a new QGIS project. Save the project and give it a name (i.e.&nbsp;Hands-on_Ex10).</p>
</blockquote>
<p><strong>Reminder:</strong> Ensure that svy21 projection system is used.</p>
</section>
<section id="preparing-base-layer-for-the-study-area" class="level3" data-number="11.2.2">
<h3 data-number="11.2.2" class="anchored" data-anchor-id="preparing-base-layer-for-the-study-area"><span class="header-section-number">11.2.2</span> Preparing base layer for the study area</h3>
<blockquote class="blockquote">
<p>DIY: Download Master Plan 2014 Subzone Boundary from data.gov.sg and import it into QGIS. Then, save the GIS layer into GeoPackage format. Name the output layer as <code>mpsz2014</code>.</p>
</blockquote>
</section>
<section id="preparing-eldercare-layer" class="level3" data-number="11.2.3">
<h3 data-number="11.2.3" class="anchored" data-anchor-id="preparing-eldercare-layer"><span class="header-section-number">11.2.3</span> Preparing eldercare layer</h3>
<blockquote class="blockquote">
<p>DIY: Download eldercare services data from data.gov.sg and import it into QGIS (Ideally, the shapefile version should be used). Then, save the GIS layer into GeoPackage format. Name the output layer as <code>eldercare</code>.</p>
</blockquote>
</section>
<section id="extracting-and-preparing-road-network-layer" class="level3" data-number="11.2.4">
<h3 data-number="11.2.4" class="anchored" data-anchor-id="extracting-and-preparing-road-network-layer"><span class="header-section-number">11.2.4</span> Extracting and preparing road network layer</h3>
<section id="selecting-all-road-network-with-the-study-area" class="level4" data-number="11.2.4.1">
<h4 data-number="11.2.4.1" class="anchored" data-anchor-id="selecting-all-road-network-with-the-study-area"><span class="header-section-number">11.2.4.1</span> Selecting all road network with the study area</h4>
<blockquote class="blockquote">
<p>DIY: Using appropriate QGIS function(s) you had learned from previous hands-on exercise, clip the road network with Singapore mainland (excluding outer insland, Pulau Tekong and Pulau Ubi). Save the GIS layer into GeoPackage format. Call the layer <code>all_roads</code>.</p>
</blockquote>
</section>
</section>
<section id="extracting-motor-vehicle-road-network" class="level3" data-number="11.2.5">
<h3 data-number="11.2.5" class="anchored" data-anchor-id="extracting-motor-vehicle-road-network"><span class="header-section-number">11.2.5</span> Extracting motor vehicle road network</h3>
<blockquote class="blockquote">
<p>DIY: Using appropriate QGIS function(s) you had learned from previous hands-on Exercise, extract motor vechicle road network (i.e.&nbsp;motorway, motorway_link, primary, primary_link, secondary, secondary_link, tertiary, tertiary_link, residential, trunk and trunk_link) from the all_roads layer. Save the GIS layer into GeoPackage format. Name the layer <code>roads</code>.</p>
</blockquote>
<p><strong>Be warn:</strong> The original data is in <strong>wgs84</strong>. For the purpose of network analysis, all network should be in projected coordinates system.</p>
<p><strong>Reminder:</strong> Remove all the source data from QGIS project before continue to the next section.</p>
</section>
</section>
<section id="analytical-hexagon" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="analytical-hexagon"><span class="header-section-number">11.3</span> Analytical Hexagon</h2>
<p>In GIS analysis, regularly shaped grids is used for many reasons such as normalizing geography for mapping or to mitigate the issues of using irregularly shaped polygons created arbitrarily (such as county boundaries or block groups that have been created from a political process). Regularly shaped grids can only be comprised of equilateral triangles, squares, or hexagons, as these three polygon shapes are the only three that can tessellate (repeating the same shape over and over again, edge to edge, to cover an area without gaps or overlaps) to create an evenly spaced grid.</p>
<p><img src="img09/image1.png" class="img-fluid"></p>
<p>Though the square (fishnet) grid is the predominantly used shape type in GIS analysis and thematic mapping, there are ways in which hexagons may be better suited for your analysis based on the nature of your question.</p>
<p>Hexagons reduce sampling bias due to edge effects of the grid shape, this is related to the low perimeter-to-area ratio of the shape of the hexagon. A circle has the lowest ratio but cannot tessellate to form a continuous grid. Hexagons are the most circular-shaped polygon that can tessellate to form an evenly spaced grid.</p>
<p><img src="img09/image2.png" class="img-fluid" style="width:55.0%"></p>
<section id="creating-hexagon-layer" class="level3" data-number="11.3.1">
<h3 data-number="11.3.1" class="anchored" data-anchor-id="creating-hexagon-layer"><span class="header-section-number">11.3.1</span> Creating hexagon layer</h3>
<p>Now, we are going to create a hexagon layer by using <code>mpsz</code> layer as the based. The hexagon distance is 250m.</p>
<ul>
<li>From the menu bar, select <strong>Vector</strong> -&gt; <strong>Research Tools</strong> -&gt; <strong>Create Grids</strong>.</li>
</ul>
<p><strong>Create Grids</strong> dialog window appears.</p>
<ul>
<li>For <strong>Grid type:</strong> select <em>Hexagon (Polygon)</em> from the drop down list.</li>
</ul>
<p><img src="img09/image1.jpg" class="img-fluid" style="width:35.0%"></p>
<ul>
<li>For <strong>Grid extend:</strong>, select <em>Calculate from Layer</em> -&gt; <code>mpsz</code></li>
</ul>
<p><img src="img09/image2.jpg" class="img-fluid" style="width:55.0%"></p>
<ul>
<li>For <strong>Horizontal spacing</strong>, type <em>500</em>.</li>
<li>For <strong>Vertical spacing</strong>, type <em>500</em>.</li>
</ul>
<blockquote class="blockquote">
<p>Question: Do you know why 500 is used?</p>
</blockquote>
<ul>
<li>For <strong>Grid CRS</strong>, make sure that <em>EPSG 3414</em> is used.</li>
</ul>
<p>When you are ready to run the process,</p>
<ul>
<li>Click on <strong>Run</strong> button.</li>
</ul>
<p><strong>Reminder:</strong> Read the Log before closing the dialog window.</p>
<ul>
<li>Click on <strong>Close</strong> button.</li>
</ul>
<p>Notice that a new temporary layer called <code>Grid</code> is added on the Layer pane and display on Map window.</p>
<p><img src="img09/image3.jpg" class="img-fluid"></p>
</section>
<section id="editing-the-hexagon-layer" class="level3" data-number="11.3.2">
<h3 data-number="11.3.2" class="anchored" data-anchor-id="editing-the-hexagon-layer"><span class="header-section-number">11.3.2</span> Editing the hexagon layer</h3>
<blockquote class="blockquote">
<p>DIY: Using appropriate QGIS functions, edit the temporary <code>Grid</code> layer until it looks similar to the screenshot below.</p>
</blockquote>
<p><img src="img09/image4.jpg" class="img-fluid"></p>
</section>
<section id="saving-the-hexagon-layer" class="level3" data-number="11.3.3">
<h3 data-number="11.3.3" class="anchored" data-anchor-id="saving-the-hexagon-layer"><span class="header-section-number">11.3.3</span> Saving the hexagon layer</h3>
<blockquote class="blockquote">
<p>DIY: Using the steps you had learned in previous hands-on exercise, save the edited <code>Grid</code> layer into GeoPackage format. Give the layer a name (i.e.&nbsp;<code>hexagon</code>)</p>
</blockquote>
<p>Before you move on to the next section, remember to remove the temporary <code>Grid</code> layer.</p>
</section>
<section id="computing-hexagon-centroid" class="level3" data-number="11.3.4">
<h3 data-number="11.3.4" class="anchored" data-anchor-id="computing-hexagon-centroid"><span class="header-section-number">11.3.4</span> Computing hexagon centroid</h3>
<p>In general, network analysis required the demand in a point feature. Hexagon, on the other hand, is a polygon feature. In order to meet the analysis need, we will compute the centroids of the hexagons.</p>
<ul>
<li>From the menu bar, select <strong>Vector</strong> -&gt; <strong>Geometry Tools</strong> -&gt; <strong>Centroids</strong>.</li>
</ul>
<p><strong>Centroids</strong> dialog window appears.</p>
<ul>
<li>For <strong>Input layer</strong>, select <em>hexagon</em> from the drop-down list.</li>
</ul>
<p>When you are ready to run the process,</p>
<ul>
<li>Click on <strong>Run</strong> button.</li>
</ul>
<p><strong>Reminder:</strong> Read the log before closing.</p>
<ul>
<li>Click on <strong>Close</strong> button.</li>
</ul>
<p>Notice that a new temporary layer called Centroid is added onto Layers panel and display on Map view.</p>
<p><img src="img09/image5.jpg" class="img-fluid"></p>
</section>
<section id="saving-the-centroid-layer" class="level3" data-number="11.3.5">
<h3 data-number="11.3.5" class="anchored" data-anchor-id="saving-the-centroid-layer"><span class="header-section-number">11.3.5</span> Saving the centroid layer</h3>
<blockquote class="blockquote">
<p>DIY: Using the steps you had learned in previous hands-on exercise, save the temporary <code>Centroids</code> layer into GepPackage format. Name the newly created layer <code>hex_centroid</code>.</p>
</blockquote>
<p>Before you move on to the next section, remember to remove the temporary <code>Centroids</code> layer.</p>
</section>
</section>
<section id="network-accessibility-analysis-with-neat3-plugin" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="network-accessibility-analysis-with-neat3-plugin"><span class="header-section-number">11.4</span> Network Accessibility Analysis with NEAT3 Plugin</h2>
<p>In this section, you will learn how to perform network accessibility analysis by using QGIS Network Analysis Toolbox (QNEAT3) plugin.</p>
<section id="installing-qneat3-plugin." class="level3" data-number="11.4.1">
<h3 data-number="11.4.1" class="anchored" data-anchor-id="installing-qneat3-plugin."><span class="header-section-number">11.4.1</span> Installing QNEAT3 plugin.</h3>
<p>Before getting started, you need to install QNEAT3 plugin.</p>
<ul>
<li>From the menu bar, select <strong>Plugins</strong> -&gt; <strong>Manage and Install plugins</strong>.</li>
</ul>
<p>Plugins dialog window appears.</p>
<ul>
<li>At the query, type <strong>QNEAT3</strong>.</li>
</ul>
<p>Notice that QNEAT3 appears on the search output list.</p>
<ul>
<li><p>Click on <strong>QNEAT3</strong>.</p></li>
<li><p>Click on <strong>Install Plugin</strong> button.</p></li>
</ul>
<p>When the installation is completed, close the dialog box by</p>
<ul>
<li>click on <strong>Close</strong> button.</li>
</ul>
</section>
<section id="working-with-od-matrix-tool" class="level3" data-number="11.4.2">
<h3 data-number="11.4.2" class="anchored" data-anchor-id="working-with-od-matrix-tool"><span class="header-section-number">11.4.2</span> Working with OD Matrix tool</h3>
<p>Next, we will use the Origin-Destination Matrix (OD Matrix) tool of QNEAT3 plugin to calculate the distances between hexagon centrois (as the demand points) and eldercare centres (as the supply points).</p>
<ul>
<li><p>From the menu bar, click on <strong>Processing</strong> -&gt; <strong>Toolbox</strong></p></li>
<li><p>At the <strong>Search</strong> pane, type <code>OD Matrix</code>.</p></li>
</ul>
<p>You screen should look similar to the screenshot below.</p>
<p><img src="img09/image26.jpg" class="img-fluid" style="width:45.0%"></p>
<ul>
<li>Click on <strong>OD Matrix Layers as Table (m:n)</strong>.</li>
</ul>
<p><strong>OD Matrix Layers as Table (m:n)</strong> dialog window appears.</p>
<ul>
<li><p>For <strong>Network Layer</strong>, select <code>roads</code> from the drop-down list.</p></li>
<li><p>For <strong>From-Point Layer</strong>, select <code>hex_centroid</code> from the drop-down list.</p></li>
<li><p>For <strong>Unique Point ID Field</strong>, select <code>fid</code> from the drop-down list.</p></li>
<li><p>For <strong>To-Point Layer</strong>, select <code>eldercare</code> fro mthe drop-down list.</p></li>
<li><p>For <strong>Unique Point ID Field</strong>, select <code>fid</code> from the drop-down list.</p></li>
<li><p>For <strong>Optimization Criterion</strong>, select <code>Shortest Path (distance optimization)</code> from the drop-down list.</p></li>
<li><p>For <strong>Entry Cost calculation method</strong>, select <code>Ellipsoidal</code> from the drop-down list.</p></li>
<li><p>For <strong>Direction field</strong>, select <code>oneway</code> from the drop-down list.</p></li>
<li><p>For <strong>Value for forward direction</strong>, type <code>F</code>.</p></li>
<li><p>For <strong>Value for backward direction</strong>, type <code>T</code>.</p></li>
<li><p>For <strong>Value for both direction</strong>, type <code>B</code>.</p></li>
<li><p>For Topology tolerance, type <em>0.5</em> (i.e.&nbsp;0.5 m).</p></li>
</ul>
<p>The completed dialog widnow should look similar to the screenshot below.</p>
<p><img src="img09/image27.jpg" class="img-fluid"></p>
<p>When you are ready to run the process.</p>
<ul>
<li>At the <strong>OD Matrix</strong> dialog window, click on <strong>Run</strong> button.</li>
</ul>
<p>Be patient, the process is computationally intensive.</p>
<p><strong>Reminder:</strong> Read the log before closing it.</p>
<p>When you are ready to close the dialog window.</p>
<ul>
<li>Click on <strong>Close</strong> button.</li>
</ul>
<p>Notice that a new temporary table called <code>Output OD Matrix</code> is added onto Layers panel.</p>
<p><img src="img09/image28.jpg" class="img-fluid" style="width:35.0%"></p>
<ul>
<li>At the Layers panel, right-click on <code>Output OD Matrix</code> and select <strong>Open Attribute Table</strong> from the context menu.</li>
</ul>
<p>A data table look similar to the screenshot below appears.</p>
<p><img src="img09/image29.jpg" class="img-fluid"></p>
<blockquote class="blockquote">
<p>Question: Do you know what are the values of these fields?</p>
</blockquote>
<blockquote class="blockquote">
<p>DIY: Using the steps you had learned, save the temporary Output OD Matrix table as GeoPackage format. Name the layer <code>OD_eldercare</code>.</p>
</blockquote>
</section>
<section id="extracting-shortest-distance-pairs" class="level3" data-number="11.4.3">
<h3 data-number="11.4.3" class="anchored" data-anchor-id="extracting-shortest-distance-pairs"><span class="header-section-number">11.4.3</span> Extracting shortest distance pairs</h3>
<p>Next, we will use the SQL tool of QGIS to select destination points with the shortest distance.</p>
<ul>
<li>At the <strong>Search</strong> pane of <strong>Processing Toolbox</strong>, type <code>SQL</code>.</li>
</ul>
<p><strong>SQL</strong> function appears on the list.</p>
<p><img src="img09/image30.jpg" class="img-fluid" style="width:45.0%"></p>
<ul>
<li>Double-click on <strong>Execute SQL</strong> of <strong>Vector general</strong>.</li>
</ul>
<p><strong>Execute SQL</strong> dialog window appears.</p>
<ul>
<li><p>For <strong>Additional input datasources</strong>, select on the button at the right end.</p></li>
<li><p>Click on the checkbox <strong>Output OD Matrix</strong>.</p></li>
</ul>
<p><img src="img09/image31.jpg" class="img-fluid" style="width:65.0%"></p>
<ul>
<li><p>Click on <strong>OK</strong> button.</p></li>
<li><p>At SQL query panel, type the following SQL</p></li>
</ul>
<p><img src="img09/image32.jpg" class="img-fluid" style="width:55.0%"></p>
<ul>
<li>For <em>Geometry type</em>, select <code>No Geometry</code> from the drop-down list.</li>
</ul>
<p><img src="img09/image33.jpg" class="img-fluid" style="width:45.0%"></p>
<p>Notice that a temporary table called <code>SQL Output</code> is added onto <strong>Layers</strong> panel. It consists of four fields. The values in <code>shortest_distance</code> field are shortest distance between demand points and its nearest eldercare centre.</p>
<p><img src="img09/image34.jpg" class="img-fluid" style="width:65.0%"></p>
<blockquote class="blockquote">
<p>DIY: Using the steps you had learned, save the temporary <code>SQL Output</code> table as GeoPackage format. Name the layer <code>acc_eldercare</code>.</p>
</blockquote>
</section>
<section id="mapping-accessibility-values" class="level3" data-number="11.4.4">
<h3 data-number="11.4.4" class="anchored" data-anchor-id="mapping-accessibility-values"><span class="header-section-number">11.4.4</span> Mapping Accessibility Values</h3>
<p>In this section, we are going to use mapping function of QGIS to show the distribution of accessibility to eldercare</p>
<section id="creating-a-duplicate-layer" class="level4" data-number="11.4.4.1">
<h4 data-number="11.4.4.1" class="anchored" data-anchor-id="creating-a-duplicate-layer"><span class="header-section-number">11.4.4.1</span> Creating a duplicate layer</h4>
<p>Before we getting started, let us create a duplicate copy of <code>hexagon</code> layer</p>
<ul>
<li>At the Layers panel, right-click on <code>hexagon</code> layer and select <strong>Duplicate Layer</strong> from the context menu.</li>
</ul>
<p>A new layer called <code>hexagon</code> copy is added onto Layers panel.</p>
<ul>
<li>Rename the layer to <code>Accesibility to eldercare</code>.</li>
</ul>
</section>
<section id="performing-relational-join." class="level4" data-number="11.4.4.2">
<h4 data-number="11.4.4.2" class="anchored" data-anchor-id="performing-relational-join."><span class="header-section-number">11.4.4.2</span> Performing relational join.</h4>
<p>Before we can prepare the choropleth map, we need to join <code>acc_eldercare</code> data table to the newly created <code>Accesibility to eldercare</code> by using <em>fid</em> of <code>acc_eldercare</code> data table and <em>fid</em> of <code>Accessibility to eldercare</code> attribute table as unique join fields.</p>
<ul>
<li>At the Layer panel, right-click on <code>Accesibility to eldercare</code> layer and select <strong>Properties</strong> from the context menu.</li>
</ul>
<p>The Properties dialog window appears.</p>
<ul>
<li><p>At the option panel, click on <strong>Joins</strong>.</p></li>
<li><p>Click on <strong>+</strong> button to add a join.</p></li>
</ul>
<p>The <strong>Add Vector Join</strong> dialog window appears.</p>
<ul>
<li><p>For <strong>Join layer</strong>, select <code>acc_eldercare</code> from th drop-down list.</p></li>
<li><p>For <strong>Join field</strong>, select <code>fid</code> from the drop-down list.</p></li>
<li><p>For <strong>Target field</strong>, select <code>fid</code> from the drop-down lsit.</p></li>
<li><p>Keep the checkbox in front of <strong>Cache join layer in memory</strong> checked.</p></li>
</ul>
<p><img src="img09/image36.jpg" class="img-fluid" style="width:45.0%"></p>
<ul>
<li>When you are ready, click on <strong>OK</strong> button.</li>
</ul>
</section>
<section id="preparing-choropleth-map" class="level4" data-number="11.4.4.3">
<h4 data-number="11.4.4.3" class="anchored" data-anchor-id="preparing-choropleth-map"><span class="header-section-number">11.4.4.3</span> Preparing choropleth map</h4>
<blockquote class="blockquote">
<p>DIY: Using the steps you had learned, prepare a choropleth map showing the distribution of accessibility to eldercare centres.</p>
</blockquote>
<p>Your choropleth map should look similar to the screenshot below.</p>
<p><img src="img09/image35.jpg" class="img-fluid"></p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Hands-on_Ex09.html" class="pagination-link" aria-label="Shortest Path Analysis: QGIS methods">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Shortest Path Analysis: QGIS methods</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Hands-on_Ex11.html" class="pagination-link" aria-label="Delineating Service Area Using Network Distance Approach">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Delineating Service Area Using Network Distance Approach</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>