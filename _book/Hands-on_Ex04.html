<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Beyond Mapping: Vector-based GIS Analysis for Urban Applications – GIS for Urban Planning: QGIS methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Hands-on_Ex05.html" rel="next">
<link href="./Hands-on_Ex03.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Hands-on_Ex04.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Beyond Mapping: Vector-based GIS Analysis for Urban Applications</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">GIS for Urban Planning: QGIS methods</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">First Date with QGIS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Working with GIS Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">GIS Mapping and Geovisualisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex04.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Beyond Mapping: Vector-based GIS Analysis for Urban Applications</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Trade Area Analysis with Vector-based GIS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Cartographic Modelling with Raster-based GIS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">GIS Modelling for Urban Land Suitability Study</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">GIS-based Multicriteria Decision Analysis (MCDA) for Land Suitability Study</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Shortest Path Analysis: QGIS methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Geography of Accessibility: QGIS methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Delineating Service Area Using Network Distance Approach</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Hands-on_Ex12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Building GeoWeb Mapping Application using QGIS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-outcome" id="toc-learning-outcome" class="nav-link active" data-scroll-target="#learning-outcome"><span class="header-section-number">5.1</span> Learning Outcome</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started"><span class="header-section-number">5.2</span> Getting Started</a>
  <ul class="collapse">
  <li><a href="#the-task" id="toc-the-task" class="nav-link" data-scroll-target="#the-task"><span class="header-section-number">5.2.1</span> The Task</a></li>
  <li><a href="#creating-the-project-folder" id="toc-creating-the-project-folder" class="nav-link" data-scroll-target="#creating-the-project-folder"><span class="header-section-number">5.2.2</span> Creating the project folder</a></li>
  <li><a href="#downloading-the-data-sets" id="toc-downloading-the-data-sets" class="nav-link" data-scroll-target="#downloading-the-data-sets"><span class="header-section-number">5.2.3</span> Downloading the data sets</a></li>
  <li><a href="#start-a-new-qgis-project" id="toc-start-a-new-qgis-project" class="nav-link" data-scroll-target="#start-a-new-qgis-project"><span class="header-section-number">5.2.4</span> Start a new QGIS project</a></li>
  </ul></li>
  <li><a href="#working-with-qgis-geoprocessing" id="toc-working-with-qgis-geoprocessing" class="nav-link" data-scroll-target="#working-with-qgis-geoprocessing"><span class="header-section-number">5.3</span> Working with QGIS geoprocessing</a>
  <ul class="collapse">
  <li><a href="#geospatial-data-wrangling-with-qgis" id="toc-geospatial-data-wrangling-with-qgis" class="nav-link" data-scroll-target="#geospatial-data-wrangling-with-qgis"><span class="header-section-number">5.3.1</span> Geospatial data wrangling with QGIS</a></li>
  <li><a href="#saving-the-selected-features-into-geopackage-database" id="toc-saving-the-selected-features-into-geopackage-database" class="nav-link" data-scroll-target="#saving-the-selected-features-into-geopackage-database"><span class="header-section-number">5.3.2</span> Saving the selected features into GeoPackage database</a></li>
  </ul></li>
  <li><a href="#geoprocessing-with-qgis" id="toc-geoprocessing-with-qgis" class="nav-link" data-scroll-target="#geoprocessing-with-qgis"><span class="header-section-number">5.4</span> Geoprocessing with QGIS</a>
  <ul class="collapse">
  <li><a href="#extracting-land-use-features-within-punggol-planning-area" id="toc-extracting-land-use-features-within-punggol-planning-area" class="nav-link" data-scroll-target="#extracting-land-use-features-within-punggol-planning-area"><span class="header-section-number">5.4.1</span> Extracting land use features within Punggol planning area</a></li>
  </ul></li>
  <li><a href="#data-visualisation-with-data-plotly-plugin" id="toc-data-visualisation-with-data-plotly-plugin" class="nav-link" data-scroll-target="#data-visualisation-with-data-plotly-plugin"><span class="header-section-number">5.5</span> Data visualisation with Data Plotly plugin</a>
  <ul class="collapse">
  <li><a href="#installing-data-plotly-plugin" id="toc-installing-data-plotly-plugin" class="nav-link" data-scroll-target="#installing-data-plotly-plugin"><span class="header-section-number">5.5.1</span> Installing Data Plotly plugin</a></li>
  <li><a href="#deriving-new-field-by-using-qgis-geometry" id="toc-deriving-new-field-by-using-qgis-geometry" class="nav-link" data-scroll-target="#deriving-new-field-by-using-qgis-geometry"><span class="header-section-number">5.5.2</span> Deriving new field by using QGIS geometry</a></li>
  <li><a href="#plotting-a-frequency-bar-chart-using-data-plotly-plugin" id="toc-plotting-a-frequency-bar-chart-using-data-plotly-plugin" class="nav-link" data-scroll-target="#plotting-a-frequency-bar-chart-using-data-plotly-plugin"><span class="header-section-number">5.5.3</span> Plotting a frequency bar chart using <strong>Data Plotly</strong> plugin</a></li>
  </ul></li>
  <li><a href="#working-with-qgis-print-layout" id="toc-working-with-qgis-print-layout" class="nav-link" data-scroll-target="#working-with-qgis-print-layout"><span class="header-section-number">5.6</span> Working with QGIS Print Layout</a>
  <ul class="collapse">
  <li><a href="#preparing-the-print-windows" id="toc-preparing-the-print-windows" class="nav-link" data-scroll-target="#preparing-the-print-windows"><span class="header-section-number">5.6.1</span> Preparing the print windows</a></li>
  <li><a href="#starts-a-new-qgis-print-layout" id="toc-starts-a-new-qgis-print-layout" class="nav-link" data-scroll-target="#starts-a-new-qgis-print-layout"><span class="header-section-number">5.6.2</span> Starts a new QGIS print layout</a></li>
  <li><a href="#adding-a-map-layer" id="toc-adding-a-map-layer" class="nav-link" data-scroll-target="#adding-a-map-layer"><span class="header-section-number">5.6.3</span> Adding a map layer</a></li>
  <li><a href="#changing-the-main-properties" id="toc-changing-the-main-properties" class="nav-link" data-scroll-target="#changing-the-main-properties"><span class="header-section-number">5.6.4</span> Changing the main properties</a></li>
  <li><a href="#adding-grid-reference" id="toc-adding-grid-reference" class="nav-link" data-scroll-target="#adding-grid-reference"><span class="header-section-number">5.6.5</span> Adding grid reference</a></li>
  <li><a href="#adding-map-legend" id="toc-adding-map-legend" class="nav-link" data-scroll-target="#adding-map-legend"><span class="header-section-number">5.6.6</span> Adding map legend</a></li>
  <li><a href="#adding-statistical-graphic" id="toc-adding-statistical-graphic" class="nav-link" data-scroll-target="#adding-statistical-graphic"><span class="header-section-number">5.6.7</span> Adding statistical graphic</a></li>
  <li><a href="#adding-scale-bar" id="toc-adding-scale-bar" class="nav-link" data-scroll-target="#adding-scale-bar"><span class="header-section-number">5.6.8</span> Adding scale bar</a></li>
  <li><a href="#adding-north-arrow" id="toc-adding-north-arrow" class="nav-link" data-scroll-target="#adding-north-arrow"><span class="header-section-number">5.6.9</span> Adding north arrow</a></li>
  <li><a href="#adding-layout-title-and-caption" id="toc-adding-layout-title-and-caption" class="nav-link" data-scroll-target="#adding-layout-title-and-caption"><span class="header-section-number">5.6.10</span> Adding layout title and caption</a></li>
  <li><a href="#exporting-print-layout" id="toc-exporting-print-layout" class="nav-link" data-scroll-target="#exporting-print-layout"><span class="header-section-number">5.6.11</span> Exporting print layout</a></li>
  </ul></li>
  <li><a href="#distance-analysis-with-vector-based-gis" id="toc-distance-analysis-with-vector-based-gis" class="nav-link" data-scroll-target="#distance-analysis-with-vector-based-gis"><span class="header-section-number">5.7</span> Distance Analysis with Vector-based GIS</a>
  <ul class="collapse">
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data"><span class="header-section-number">5.7.1</span> The data</a></li>
  <li><a href="#preparing-pre-school-location-layer" id="toc-preparing-pre-school-location-layer" class="nav-link" data-scroll-target="#preparing-pre-school-location-layer"><span class="header-section-number">5.7.2</span> Preparing pre-school location layer</a></li>
  <li><a href="#preparing-residential-building-layer" id="toc-preparing-residential-building-layer" class="nav-link" data-scroll-target="#preparing-residential-building-layer"><span class="header-section-number">5.7.3</span> Preparing residential building layer</a></li>
  <li><a href="#deriving-centroids-of-residentail-polygon-features" id="toc-deriving-centroids-of-residentail-polygon-features" class="nav-link" data-scroll-target="#deriving-centroids-of-residentail-polygon-features"><span class="header-section-number">5.7.4</span> Deriving centroids of residentail polygon features</a></li>
  <li><a href="#computing-distance-matrix" id="toc-computing-distance-matrix" class="nav-link" data-scroll-target="#computing-distance-matrix"><span class="header-section-number">5.7.5</span> Computing distance matrix</a></li>
  <li><a href="#symbolosing-distance-values" id="toc-symbolosing-distance-values" class="nav-link" data-scroll-target="#symbolosing-distance-values"><span class="header-section-number">5.7.6</span> Symbolosing distance values</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Beyond Mapping: Vector-based GIS Analysis for Urban Applications</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The true power of a GIS of is its geoprocessing and analysis capability. <strong>Geoprocessing</strong> is a GIS operation used to manipulate GIS data. A typical geoprocessing operation takes an input dataset, performs an operation on that dataset, and returns the result of the operation as an output dataset. Common geoprocessing operations include geographic feature overlay, feature selection and analysis, topology processing, raster processing, and data conversion.</p>
<p>GIS analysis, on the other hand, is the process of examining the locations, attributes, and relationships of features in spatial data through overlay and other analytical techniques in order to address a question or gain useful geospatial knowledge. GIS analysis extracts or creates new information from spatial data.</p>
<p>In this hands-on exercise, you will learn how to combine geoprocessing and GIS analysis functions of QGIS to meet urban application needs.</p>
<section id="learning-outcome" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="learning-outcome"><span class="header-section-number">5.1</span> Learning Outcome</h2>
<p>By the end of this session, you will be able to:</p>
<ul>
<li><p>extract geospatial data by using appropriate geoprocessing functions of QGIS,</p></li>
<li><p>create a GeoPackage database and save the extracted geospatial data into GeoPackage data table,</p></li>
<li><p>transform the referencing system of the geospatial data into from geographic coordinate system (i.e wgs84) to projected coordinate system (i.e svy21). integration using appropriate overlay and statistical analysis functions of QGIS,</p></li>
<li><p>derive new field from geospatial properties by using QGIS attribute table tools, and</p></li>
<li><p>prepare statistical graphic by using <strong>Data Plotly</strong> plugin of QGIS.</p></li>
</ul>
</section>
<section id="getting-started" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="getting-started"><span class="header-section-number">5.2</span> Getting Started</h2>
<section id="the-task" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="the-task"><span class="header-section-number">5.2.1</span> The Task</h3>
<p>Every fives years, Urban Redevelopment Authority of Singapore will publish the new Land-Use Master Plan (MP). It is the statutory land use plan which guides Singapore’s development in the medium term over the next 10 to 15 years. The latest version was published in 2019 and the digital version is available at data.gov.sg.</p>
<p>In this hands-on exercise we are interested to understand the distribution of land areas by land-use allocation at the planning subzone level. The target planning area is Punggol area which comprises of seven subzones.</p>
<p>Two data sets will be used in this exericse, they are:</p>
<ul>
<li><p><a href="https://data.gov.sg/dataset/master-plan-2019-subzone-boundary-no-sea">Master Plan 2019 Subzone Boundary (No Sea)</a></p></li>
<li><p><a href="https://data.gov.sg/dataset/master-plan-2019-land-use-layer">Master Plan 2019 Land Use layer</a></p></li>
</ul>
</section>
<section id="creating-the-project-folder" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="creating-the-project-folder"><span class="header-section-number">5.2.2</span> Creating the project folder</h3>
<ul>
<li><p>Create a new project folder called <code>Hands-on_Ex04</code> or any name of your choice.</p></li>
<li><p>Create a new sub-folder called <code>data.gov</code> or any name of your choice.</p></li>
</ul>
</section>
<section id="downloading-the-data-sets" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="downloading-the-data-sets"><span class="header-section-number">5.2.3</span> Downloading the data sets</h3>
<blockquote class="blockquote">
<p>DIY: Perform the following steps by using the steps you had learned from the previous hands-on exercise:</p>
<ol type="1">
<li><p>download both data sets,</p></li>
<li><p>place them in the newly created <code>data.gov</code> sub-folder, and</p></li>
<li><p>unzip both data sets.</p></li>
</ol>
</blockquote>
</section>
<section id="start-a-new-qgis-project" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="start-a-new-qgis-project"><span class="header-section-number">5.2.4</span> Start a new QGIS project</h3>
<blockquote class="blockquote">
<p>DIY: Using the steps you had learned from the previous hands-on exercise:</p>
<ul>
<li><p>Launch QGIS.</p></li>
<li><p>Start a new QGIS project.</p></li>
<li><p>Save the project in <code>Hands-on_Ex04</code> folder. Name the project <code>Hands-on_Ex04</code> or any other name of your choice.</p></li>
</ul>
</blockquote>
</section>
</section>
<section id="working-with-qgis-geoprocessing" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="working-with-qgis-geoprocessing"><span class="header-section-number">5.3</span> Working with QGIS geoprocessing</h2>
<section id="geospatial-data-wrangling-with-qgis" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="geospatial-data-wrangling-with-qgis"><span class="header-section-number">5.3.1</span> Geospatial data wrangling with QGIS</h3>
<p>Now, we are going to extract planning sub-zones belong to Punggol planning area from <code>URA_MP19_SUBZONE_NO_SEA_PL</code> layer.</p>
<ul>
<li>From the Layer pane, right click on <code>URA_MP19_SUBZONE_NO_SEA_PL</code></li>
<li>Select <strong>Open Attribute Table</strong> from the context menu.</li>
</ul>
<p>The attribute table of <code>URA_MP19_SUBZONE_NO_SEA_PL</code> appears.</p>
<ul>
<li>From the menu bar of attribute table of <code>URA_MP19_SUBZONE_NO_SEA_PL</code>, click on <strong>Select Features using an Expression</strong> <img src="img04/image3.jpg" class="img-fluid">icon</li>
</ul>
<p><strong>Select by Expression</strong> dialog window appears.</p>
<p><img src="img04/image4.jpg" class="img-fluid"></p>
<ul>
<li>Click on the black triangle in front of <em>Fields and Values</em>.</li>
</ul>
<p><img src="img04/image5.jpg" class="img-fluid"></p>
<p>A list of field names appears.</p>
<ul>
<li>Double-click on <code>PLN_AREA_N</code> (i.e.&nbsp;Planning Area Name)</li>
</ul>
<p>The <strong>Expression</strong> pane should look similar to the screenshot below.</p>
<p><img src="img04/image6.jpg" class="img-fluid" width="300"></p>
<ul>
<li>At the bottom of <strong>Expression</strong> pane, click on <img src="img04/image7.jpg" class="img-fluid"> icon.</li>
</ul>
<p>The <strong>Expression</strong> pane should look similar to the screenshot below.</p>
<p><img src="img04/image8.jpg" class="img-fluid" width="300"></p>
<ul>
<li>From the right of <strong>Select by Expression</strong> dialog window, click on <strong>All Unique</strong> button.</li>
</ul>
<p>Notice that a complete list of unique value in the <code>PLN_AREA_N</code> appears.</p>
<p><img src="img04/image9.jpg" class="img-fluid" width="200"></p>
<ul>
<li>Scroll down the list until you see <code>Punggol</code>. Double click on the word <code>Punggol</code>.</li>
</ul>
<p>The <strong>Expression</strong> pane should look similar to the screenshot below.</p>
<p><img src="img04/image10.jpg" class="img-fluid" width="300"></p>
<ul>
<li>Click on <img src="img04/image11.jpg" class="img-fluid" width="136"> button located at the right hand corner of the dialog window.</li>
</ul>
<p>Notice that the top bar of the attribute table window indicates that 7 records have been selected.</p>
<p><img src="img04/image12.jpg" class="img-fluid"></p>
<ul>
<li>From the <strong>Select by Expression</strong> dialog window, click on <strong>Close</strong> button located at the lower right corner.</li>
</ul>
<p>To confirm that the records have been selected correctly,</p>
<ul>
<li>From the menu bar the the attribute table, click on <img src="img04/image13.jpg" class="img-fluid" width="17"></li>
</ul>
<p>Notice that the selected records will be populated as shown below.</p>
<p><img src="img04/image14.jpg" class="img-fluid"></p>
<p>You can close the attribute table now.</p>
<ul>
<li>Click on the cross icon located at the upper right corner of the attribute table.</li>
</ul>
</section>
<section id="saving-the-selected-features-into-geopackage-database" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="saving-the-selected-features-into-geopackage-database"><span class="header-section-number">5.3.2</span> Saving the selected features into GeoPackage database</h3>
<p>Now we are going to save the selected features into a new data layer in a GeoPackage database.</p>
<ul>
<li><p>From the <strong>Layers</strong> panel, right-click on <code>URA_MP19_SUBZONE_NO_SEA_PL</code>.</p></li>
<li><p>Select <strong>Export</strong> -&gt; <strong>Save Selected Features as..</strong> from the context menu.</p></li>
</ul>
<p><strong>Save Vector Layer as..</strong> dialog window appears.</p>
<p><img src="img04/image15.jpg" class="img-fluid" width="303"></p>
<ul>
<li><p>For <em>Format</em>, select <code>GeoPackage</code> from the drop-down list.</p></li>
<li><p>For <em>File Name</em>, click on the button located at the back.</p></li>
</ul>
<p><strong>Save Layer as</strong> dialog window appears</p>
<p><img src="img04/image16.jpg" class="img-fluid"></p>
<ul>
<li><p>Create a sub-folder in the <code>Hands-on_Ex04</code> folder. Called the newly created sub-folder <code>GeoPackage</code>.</p></li>
<li><p>Double-click on <code>GeoPackage</code> sub-folder to navigate into the sub-folder.</p></li>
<li><p>For <em>File name</em>, type <code>Punggol</code>.</p></li>
<li><p>Click on <strong>Save</strong> button.</p></li>
</ul>
<p>Now, you will be back to <strong>Save Vector Layer as..</strong> dialog window.</p>
<ul>
<li>For <em>Layer name</em>, type <code>MP19 Subzone</code>.</li>
</ul>
<blockquote class="blockquote">
<p>DIY: For <em>CRS</em>, using the steps you have learned, change to <code>svy21</code> projection coordinate system.</p>
</blockquote>
<p>The complete interface should look similar to the screenshot below.</p>
<p><img src="img04/image17.jpg" class="img-fluid" width="315"></p>
<ul>
<li><p>Check to make sure that the check-box in front of <em>Save on selected features</em> is checked.</p></li>
<li><p>When you are ready, click on <strong>Ok</strong> button to run the function.</p></li>
</ul>
<p>Notice that a new GIS layer called <code>Punggol --- MP19 Subzone</code> has been add on Layers pane and display on map view as shaded polygons.</p>
<p><img src="img04/image18.jpg" class="img-fluid"></p>
<p>By referring to <code>Hands-on_Ex04</code> folder in <strong>Browser</strong> panel, you will see that a new GeoPackage called <code>Punggol.gpkg</code> has been created with a data table called <code>MP19 Subzone</code>.</p>
<p><img src="img04/image19.jpg" class="img-fluid"></p>
<blockquote class="blockquote">
<p>DIY: Using the steps you had learned from previous hands-on, examine the properties of <code>MP19 Subzone</code> layer.</p>
</blockquote>
<p>Your screen should look similar to the screenshot below.</p>
<p><img src="img04/image20.jpg" class="img-fluid"></p>
<p>Notice that the layer is in svy21 Projected Coordinate System and not in the original wgs84 Geographic Coordinate System.</p>
</section>
</section>
<section id="geoprocessing-with-qgis" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="geoprocessing-with-qgis"><span class="header-section-number">5.4</span> Geoprocessing with QGIS</h2>
<section id="extracting-land-use-features-within-punggol-planning-area" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="extracting-land-use-features-within-punggol-planning-area"><span class="header-section-number">5.4.1</span> Extracting land use features within Punggol planning area</h3>
<p>In this section, you will learn how to use the clip operation of geoprocessing function to extract land use features fall within Punggol planning area.</p>
<ul>
<li>From the menu bar, select <strong>Vector</strong> -&gt; <strong>Geoprocessing Tool</strong>s -&gt; <strong>Clip</strong>.</li>
</ul>
<p><img src="img04/image21.jpg" class="img-fluid"></p>
<p><strong>Clip</strong> dialog window appears.</p>
<ul>
<li><p>For <em>Input layer</em>, select <code>G_MP19_LAND_USE_PL</code> from the drop-down list.</p></li>
<li><p>For <em>Overlay layer</em>, select <code>Punggol --- MP19 Subzone</code> from the drop-down list.</p></li>
</ul>
<p><strong>Clip</strong> dialog window should look similar to the screenshot below.</p>
<p><img src="img04/image23.jpg" class="img-fluid"></p>
<ul>
<li>When you are ready to run the process, click on <strong>Run</strong> button.</li>
</ul>
<p>Op! It seems that the process failed to complete due to invalid geometry issue.</p>
<p><img src="img04/image24.jpg" class="img-fluid"></p>
<p>Less worry, this is very common in geoprocessing operations because of dirty or untidy data such as slivers. The issue can be addressed by using the Advanced options tool of QGIS’s geoprocessing operations.</p>
<ul>
<li><p>At <strong>Clip</strong> dialog window, click on <strong>Parameters</strong> tab.</p>
<p><img src="img04/image25.jpg" class="img-fluid" width="199"></p></li>
<li><p>Click on <strong>Advanced options</strong> <img src="img04/image22.jpg" class="img-fluid" width="27"> button behind Input layer.</p></li>
</ul>
<p><strong>Clip</strong> dialog window change as shown below.</p>
<p><img src="images/paste-21713C8F.png" class="img-fluid"></p>
<ul>
<li>For <em>Invalid feature filtering</em>, select <em>Do not Filter (Better Performance)</em> from the drop-down list.</li>
</ul>
<p><img src="img04/image27.jpg" class="img-fluid"></p>
<blockquote class="blockquote">
<p>DIY: Repeat the same steps for <em>Overlay layer</em> too.</p>
</blockquote>
<ul>
<li>When you are ready, click on <strong>Run</strong> button one more time.</li>
</ul>
<p>Be patient, there are a lot of polygon features to be extracted. If the process is completed without any error, the Log will look similar to below.</p>
<p><img src="img04/image28.jpg" class="img-fluid"></p>
<ul>
<li>Click on <strong>Close</strong> button to close the dialog window.</li>
</ul>
<p>When you refer to <strong>Layers</strong> panel, a new data layer called Clipped is added. Notice that there is a small marker <img src="img04/image30.jpg" class="img-fluid" width="21"> at the end of the layer name. It indicates that this layer is a virtual layer. In geoprocessing, it is always a good practice to keep the output layer a virtual layer first. After checking the correctness of the output layer, then only we will go ahead and save the layer into GeoPackage database.</p>
<blockquote class="blockquote">
<p>DIY: Using the steps you had learned, save the <code>Clipped</code> virtual layer into GeoPackage, call the data layer <code>MP19 Land Use</code>.</p>
</blockquote>
<blockquote class="blockquote">
<p>DIY: Using the steps you had learned, remove <code>Clipped</code> virtual layer, <code>URA_MP19_SUBZONE_NO_SEA_PL</code>, and <code>G_MP19_LAND_USE_PL</code> layers from the <strong>Layers</strong> panel.</p>
</blockquote>
<p>You screen should look similar to the screenshot below.</p>
<p><img src="img04/image31.jpg" class="img-fluid"></p>
<blockquote class="blockquote">
<p>DIY: Using the steps you had learned in previous hands-on, symbolise the land-use by land-use classes.</p>
</blockquote>
<p><img src="img04/image32.jpg" class="img-fluid"></p>
</section>
</section>
<section id="data-visualisation-with-data-plotly-plugin" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="data-visualisation-with-data-plotly-plugin"><span class="header-section-number">5.5</span> Data visualisation with Data Plotly plugin</h2>
<section id="installing-data-plotly-plugin" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="installing-data-plotly-plugin"><span class="header-section-number">5.5.1</span> Installing Data Plotly plugin</h3>
<p>In this section, you will learn how to visualise the distribution of land-use class by area graphically by using <a href="https://github.com/ghtmtt/DataPlotly"><strong>Data Plotly</strong></a> plugin.</p>
<ul>
<li>At the menu bar, click on <strong>Plugins</strong> -&gt; <strong>Manage and Install plugins</strong>.</li>
</ul>
<p><strong>Plugins</strong> dialog window appears.</p>
<ul>
<li>Search for <strong>Data Plotly</strong>.</li>
</ul>
<p><img src="img04/image33.jpg" class="img-fluid"></p>
<ul>
<li>Click on <strong>Install Plugin</strong> button to install it.</li>
</ul>
<p>Notice that a new icon will be added on the menu bar. Feel free to move it around and place it on the icon bar.</p>
</section>
<section id="deriving-new-field-by-using-qgis-geometry" class="level3" data-number="5.5.2">
<h3 data-number="5.5.2" class="anchored" data-anchor-id="deriving-new-field-by-using-qgis-geometry"><span class="header-section-number">5.5.2</span> Deriving new field by using QGIS geometry</h3>
<p>In order to display the distribution of land-use class by area, we need to calculate and store the area of each polygon features in the attribute table.</p>
<ul>
<li><p>From the <strong>Layers</strong> panel, right-click on <code>Punggol --- MP19 LAND USE</code>.</p></li>
<li><p>Select <strong>Open Attribute Table</strong> from the context menu.</p></li>
</ul>
<p>The attribute table of <code>Punggol --- MP19 LAND USE</code> layer appears.</p>
<ul>
<li><p>Click on <strong>Open Calculate Field</strong> <img src="img04/image35.jpg" class="img-fluid" width="26"> icon.</p></li>
<li><p>Keep the box in front of <strong>Create a new field</strong> checked.</p></li>
<li><p>For <em>Output field name</em>, type <code>AREA</code>.</p></li>
<li><p>For <em>Output field</em> type, select <em>Decimal number</em> from the drop-down list.</p></li>
</ul>
<p><img src="img04/image36.jpg" class="img-fluid" width="261"></p>
<ul>
<li><p>At the <strong>Expression</strong> pane, click on the black triangle in front of <strong>Geometry</strong>.</p></li>
<li><p>Double click on <strong>$area</strong>. (Notice that there are two area fields, one is $area and the other is area).</p></li>
</ul>
<p><img src="img04/image37.jpg" class="img-fluid"></p>
<p>Notice that the <strong>Expression</strong> panel is complete with <code>\$area</code>.</p>
<ul>
<li>Click on <strong>Ok</strong> button.</li>
</ul>
<p>When the process is completed, a new field called AREA will be added in the last column of the attribute table as shown below.</p>
<p><img src="img04/image38.jpg" class="img-fluid"></p>
<ul>
<li>Close the attribute table.</li>
</ul>
<p>Next, we will save the newly derived field.</p>
<ul>
<li><p>At the <strong>Layers</strong> panel, right-click on <code>Punggol --- MP19 LAND USE</code> layer.</p></li>
<li><p>From the context menu, select <strong>Toggle Editing</strong>.</p></li>
</ul>
<p><strong>Toggle Editing</strong> dialog window appears.</p>
<p><img src="img04/image39.jpg" class="img-fluid" width="177"></p>
<ul>
<li>Click on <strong>Save</strong> button.</li>
</ul>
</section>
<section id="plotting-a-frequency-bar-chart-using-data-plotly-plugin" class="level3" data-number="5.5.3">
<h3 data-number="5.5.3" class="anchored" data-anchor-id="plotting-a-frequency-bar-chart-using-data-plotly-plugin"><span class="header-section-number">5.5.3</span> Plotting a frequency bar chart using <strong>Data Plotly</strong> plugin</h3>
<p>Now, we are ready to create the statistical plot by using Data Plotly plugin.</p>
<ul>
<li>From the icon bar, click on <strong>Data Plotly</strong> icon.</li>
</ul>
<p><strong>Data Plotly</strong> dialog window appears.</p>
<ul>
<li><p>For <em>Plot type</em>, select <code>Bar Plot</code> from the drop-down list.</p></li>
<li><p>For <em>Layer</em>, select <code>Punggol -- MP19 LAND USE</code> from the drop-down list.</p></li>
<li><p>For <em>X field</em>, select <code>LU_DESC</code> from the drop-down list.</p></li>
<li><p>For <em>Y field</em>, select <code>AREA</code> from the drop-down list.</p></li>
</ul>
<p><img src="img04/image40.jpg" class="img-fluid"></p>
<ul>
<li>When you are ready, click on <strong>Create Plot</strong> button.</li>
</ul>
<p>A bar chart look similar to the screenshot below appears.</p>
<p><img src="img04/image41.jpg" class="img-fluid"></p>
<p>Well done! You have create a bar chart showing the distribution of land areas by land-use class within Punggol planning area.</p>
</section>
</section>
<section id="working-with-qgis-print-layout" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="working-with-qgis-print-layout"><span class="header-section-number">5.6</span> Working with QGIS Print Layout</h2>
<p>In this section, you will learn how to use QGIS <strong>Print Layout</strong> platform to create a land use map for printing or publishing purposes.</p>
<section id="preparing-the-print-windows" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="preparing-the-print-windows"><span class="header-section-number">5.6.1</span> Preparing the print windows</h3>
<p>Before we make a map using Print Layout, it is important for us to ensure that an appropriate coordinate referencing system is used. For the purpose of this hands-on exercise, let us use SVY21 as the coordinate referencing system.</p>
<ul>
<li>Ensure that EPSG: 3414 is indicated at the lower right corner on QGIS’s Window.</li>
</ul>
<p><img src="img04/image42.jpg" class="img-fluid"></p>
<ul>
<li>Next, reshape QGIS Window until the white spaces in the GIS layer as minimum as possibe.</li>
</ul>
<p><img src="img04/image43.jpg" class="img-fluid"></p>
</section>
<section id="starts-a-new-qgis-print-layout" class="level3" data-number="5.6.2">
<h3 data-number="5.6.2" class="anchored" data-anchor-id="starts-a-new-qgis-print-layout"><span class="header-section-number">5.6.2</span> Starts a new QGIS print layout</h3>
<ul>
<li>From the menu bar, select Project -&gt; New Print Layout.</li>
</ul>
<p>Create Print Layout dialog window appears.</p>
<p><img src="img04/image44.jpg" class="img-fluid" width="372"></p>
<ul>
<li><p>Provide the layout an appropriate title such as Punggol Land Use.</p></li>
<li><p>Click on OK button when it is ready.</p></li>
</ul>
<p>A new Print Layout dialog window appears.</p>
<p><img src="img04/image45.jpg" class="img-fluid"></p>
<ul>
<li>From the menu bar, click on on Zoom full button <img src="img04/image48.jpg" width="21" height="25"> to display the full extent of Print Layout window.</li>
</ul>
</section>
<section id="adding-a-map-layer" class="level3" data-number="5.6.3">
<h3 data-number="5.6.3" class="anchored" data-anchor-id="adding-a-map-layer"><span class="header-section-number">5.6.3</span> Adding a map layer</h3>
<p>Next, we will add the Land Use map layer onto the layout.</p>
<ul>
<li>From menu bar, select <strong>Add Item</strong> -&gt; <strong>Add Map</strong>.</li>
</ul>
<p><img src="img04/image46.jpg" class="img-fluid" width="463"></p>
<ul>
<li>Once the Add Map mode is active, hold the left mouse button and drag a rectangle where you want to insert the map like shown below.</li>
</ul>
<p><img src="img04/image47.jpg" class="img-fluid"></p>
<ul>
<li>Release your left finger from the left mouse button.</li>
</ul>
<p>Your screen should look similar to the screenshot below.</p>
<p><img src="img04/image49.jpg" class="img-fluid"></p>
<p>Notice that a new item called Map 1 has been added on the items panel.</p>
</section>
<section id="changing-the-main-properties" class="level3" data-number="5.6.4">
<h3 data-number="5.6.4" class="anchored" data-anchor-id="changing-the-main-properties"><span class="header-section-number">5.6.4</span> Changing the main properties</h3>
<p>Let us adjust the map scale.</p>
<ul>
<li>From the <strong>Item Properties</strong> panel, look for <strong>Main Properties</strong> then enter <code>30000</code> as <em>Scale</em> value. (Note: Use other rounding values deem appropriate for your layout)</li>
</ul>
<p><img src="img04/image50.jpg" class="img-fluid" width="583"></p>
<p>In order to prevent the view on the layout changes when we turn on/off some layers or change their styles, it is important for us to lock the layers and styles.</p>
<ul>
<li>Scroll the Main Properties panel down until Layers appears.</li>
<li>Click on the check box in front of <em>Lock layers</em> and <em>Lock styles for layers</em>.</li>
</ul>
<p><img src="img04/image51.jpg" class="img-fluid"></p>
</section>
<section id="adding-grid-reference" class="level3" data-number="5.6.5">
<h3 data-number="5.6.5" class="anchored" data-anchor-id="adding-grid-reference"><span class="header-section-number">5.6.5</span> Adding grid reference</h3>
<p>Next, we will add grid reference for the map.</p>
<ul>
<li><p>From the <strong>Items Properties</strong> panel, scroll down until <strong>Grids</strong> sub-panel appears.</p></li>
<li><p>Click on <img src="img04/image52.jpg" width="85" height="25"></p></li>
</ul>
<p>A new grid frame called Grid 1 is added as shown below.</p>
<p><img src="images/paste-FE1E269B.png" class="img-fluid"></p>
<p>Next ,we are going to add a 1000m by 1000m grid on the layout.</p>
<ul>
<li><p>Click on <strong>Modify Grid</strong> button.</p></li>
<li><p>Scroll down until Appearance sub-panel appears.</p></li>
<li><p>For <strong>X</strong>, enter 1000.</p></li>
<li><p>For <strong>Y</strong>, enter 1000.</p></li>
</ul>
<p><img src="img04/image54.jpg" class="img-fluid" width="592"></p>
<p>Next, we will change the line colour to gray.</p>
<ul>
<li>Click on the drop-down list behind <strong>Line style</strong>.</li>
</ul>
<p><img src="img04/image55.jpg" class="img-fluid"></p>
<p>The colour panel appears.</p>
<p><img src="img04/image56.jpg" class="img-fluid" width="223"></p>
<ul>
<li>Choose one of the light gray colour from the panel.</li>
</ul>
<p>Notice that a light gray grid frame is added on the layout.</p>
<p><img src="img04/image57.jpg" class="img-fluid"></p>
<p>Next, we are going to turn on the coordinates.</p>
<ul>
<li><p>Scroll down the <strong>Map Grid Properties</strong> panel until <strong>Draw Coordinates</strong> sub-panel appears.</p></li>
<li><p>Click on the check-box in front of <strong>Draw Coordinates</strong>.</p></li>
</ul>
<p>Your screen should look similar to the screenshot below.</p>
<p><img src="img04/image58.jpg" class="img-fluid"></p>
<p>By default the grid reference appears on the four axis of the map layout. We are going to turn off the grid reference on the right and bottom of the layout.</p>
<ul>
<li>From the <strong>Right</strong> sub-panel, click on the drop-down list and select <em>Disable</em>.</li>
</ul>
<p><img src="img04/image59.jpg" class="img-fluid"></p>
<p>Notice that the right grid reference disappeared.</p>
<p><img src="img04/image60.jpg" class="img-fluid"></p>
<blockquote class="blockquote">
<p>DIY: Repeat the step you learned to turn off the bottom grid reference.</p>
</blockquote>
<p>The map layout should look similar to the screenshot below.</p>
<p><img src="img04/image61.jpg" class="img-fluid"></p>
</section>
<section id="adding-map-legend" class="level3" data-number="5.6.6">
<h3 data-number="5.6.6" class="anchored" data-anchor-id="adding-map-legend"><span class="header-section-number">5.6.6</span> Adding map legend</h3>
<p>Now, we are going to add map legend onto the layout.</p>
<ul>
<li>From the menu bar, select <strong>Add Item</strong> -&gt; <strong>Add Legend</strong>.</li>
</ul>
<p><img src="img04/image62.jpg" class="img-fluid"></p>
<ul>
<li>Press on the left mouse button, drag a window on the right hand side of the map layout as shown below.</li>
</ul>
<p><img src="img04/image63.jpg" class="img-fluid"></p>
<ul>
<li>Release the left mouse button.</li>
</ul>
<p>The map legend will be added onto the layout.</p>
<p><img src="img04/image64.jpg" class="img-fluid"></p>
<p>Since this layout will focus on Land Use Map alone, we are going to remove other unrelated items from the legend.</p>
<ul>
<li>From <strong>Legend Items</strong> sub-panel, click on the check-box in front of <em>Only show items inside linked map</em>.</li>
</ul>
<p><img src="img04/image65.jpg" class="img-fluid"></p>
<p>Notice that Punggol-MP19 Subzone disappeared from the legend.</p>
</section>
<section id="adding-statistical-graphic" class="level3" data-number="5.6.7">
<h3 data-number="5.6.7" class="anchored" data-anchor-id="adding-statistical-graphic"><span class="header-section-number">5.6.7</span> Adding statistical graphic</h3>
<p>One of the nice feature of QGIS layout is it allows statistical graphic to be added onto the layout.</p>
<ul>
<li>From menu bar, select Add Item -&gt; Add Plot Item.</li>
</ul>
<p><img src="img04/image66.jpg" class="img-fluid"></p>
<ul>
<li>Press on left mouse button and drag a window at the lower right corner of the layout as shown below.</li>
</ul>
<p><img src="img04/image67.jpg" class="img-fluid"></p>
<ul>
<li><p>Release the left mouse button.</p></li>
<li><p>From the Items panel, click on <em>scatter,</em> then click on <strong>Setup Selected Plot</strong> button.</p></li>
</ul>
<p><img src="img04/image68.jpg" class="img-fluid"></p>
<ul>
<li>For <strong>Plot type</strong>, click on the drop-down list and select <strong>Bar Plot</strong>.</li>
</ul>
<p><img src="img04/image69.jpg" class="img-fluid"></p>
<ul>
<li><p>For <em>X field,</em> select LU_DESC from the drop-down list.</p></li>
<li><p>For <em>Y field</em>, select AREA from the drop-down list.</p></li>
</ul>
<p><img src="img04/image70.jpg" class="img-fluid"></p>
<ul>
<li>At the <strong>Properties</strong> sub-panel, click on <strong>Update Plot</strong> button.</li>
</ul>
<p><img src="img04/image71.jpg" class="img-fluid"></p>
<p>Notice that a bar chart showing distribution of Land use class by area has been added onto the layout.</p>
<p><img src="img04/image72.jpg" class="img-fluid"></p>
</section>
<section id="adding-scale-bar" class="level3" data-number="5.6.8">
<h3 data-number="5.6.8" class="anchored" data-anchor-id="adding-scale-bar"><span class="header-section-number">5.6.8</span> Adding scale bar</h3>
<p>Now we are going to add scale bar onto the layout.</p>
<ul>
<li>From the menu bar, select <strong>Add Item</strong> -&gt; <strong>Add Scale Bar</strong>.</li>
</ul>
<p><img src="img04/image73.jpg" class="img-fluid"></p>
<ul>
<li>Press on the left mouse button, drag a window at the lower left corner of the layout as shown below.</li>
</ul>
<p><img src="img04/image74.jpg" class="img-fluid"></p>
<ul>
<li>Release the left mouse button.</li>
</ul>
<p>Notice that a scale bar has been added onto the lower left corner of the layout.</p>
<p><img src="img04/image75.jpg" class="img-fluid"></p>
<p>Let us change the scale label to km.</p>
<ul>
<li>From <strong>Unit</strong> sub-panel, click on the drop-down list behind <em>Scalebar units</em> and select <em>Kilometers</em> from the drop-down list.</li>
</ul>
<p><img src="img04/image76.jpg" class="img-fluid"></p>
<p>Next, we are going to increase the scale bar segment from 2 to 4.</p>
<ul>
<li>From <strong>Segment</strong> sub-panel, at <em>right</em>, type <em>4</em>.</li>
</ul>
<p><img src="img04/image77.jpg" class="img-fluid"></p>
<p>Notice that the scale bar at the lower left corner of the layout change to four segments.</p>
<p><img src="img04/image78.jpg" class="img-fluid"></p>
</section>
<section id="adding-north-arrow" class="level3" data-number="5.6.9">
<h3 data-number="5.6.9" class="anchored" data-anchor-id="adding-north-arrow"><span class="header-section-number">5.6.9</span> Adding north arrow</h3>
<p>Next, we will add a north arrow on top of the scale bar.</p>
<ul>
<li>From the menu bar, select <strong>Add Item</strong> -&gt; <strong>Add North Arrow</strong>.</li>
</ul>
<p><img src="img04/image79.jpg" class="img-fluid"></p>
<ul>
<li>Press on the left mouse button and drag a small window onto of the scale bar.</li>
</ul>
<p><img src="img04/image80.jpg" class="img-fluid"></p>
<ul>
<li>Release the left mouse button.</li>
</ul>
<p>Notice that a north arrow has been added onto the layout.</p>
<p><img src="img04/image81.jpg" class="img-fluid"></p>
</section>
<section id="adding-layout-title-and-caption" class="level3" data-number="5.6.10">
<h3 data-number="5.6.10" class="anchored" data-anchor-id="adding-layout-title-and-caption"><span class="header-section-number">5.6.10</span> Adding layout title and caption</h3>
<p>Next, we are going to add layout title.</p>
<ul>
<li>From the menu bar, select <strong>Add Item</strong> -&gt; <strong>Add Label</strong>.</li>
</ul>
<p><img src="img04/image82.jpg" class="img-fluid"></p>
<ul>
<li>Press on the left mouse button and drag a small but long window at the top of the map box.</li>
</ul>
<p><img src="img04/image83.jpg" class="img-fluid"></p>
<ul>
<li>At the Main Properties, type the following text.</li>
</ul>
<p><img src="img04/image84.jpg" class="img-fluid"></p>
<p>Next, we are going change to a bigger font size.</p>
<ul>
<li>From the appearance sub-panel, click on the drop-down list behind Font.</li>
</ul>
<p><img src="img04/image85.jpg" class="img-fluid"></p>
<p>The Font size window appears.</p>
<ul>
<li>Change the font size to <em>24</em>.</li>
</ul>
<p><img src="img04/image86.jpg" class="img-fluid" width="253"></p>
<p>Next, change the title horizontal alignment to centre and vertical alignment to middle.</p>
<ul>
<li><p>For <em>Horizontal alignment</em>, click on the radio button in front of <em>Center</em>.</p></li>
<li><p>For <em>Vertical alignment</em>, click on the radio button in front of <em>Middle</em>.</p></li>
</ul>
<p><img src="img04/image87.jpg" class="img-fluid"></p>
<p>The print layout should look similar to the screenshot below.</p>
<p><img src="img04/image88.jpg" class="img-fluid"></p>
<blockquote class="blockquote">
<p>DIY: Using the steps you learned, add a caption below the scale bar. The caption should mention the data source such as “Source: URA MP2019, digital version was downloaded from data.gov.sg”</p>
</blockquote>
<p>The final layout should look similar to the screenshot below.</p>
<p><img src="img04/image89.jpg" class="img-fluid"></p>
<ul>
<li>Lastly, remember to click on the Save <img src="img04/image90.jpg" width="30" height="30"> button to save the layout.</li>
</ul>
</section>
<section id="exporting-print-layout" class="level3" data-number="5.6.11">
<h3 data-number="5.6.11" class="anchored" data-anchor-id="exporting-print-layout"><span class="header-section-number">5.6.11</span> Exporting print layout</h3>
<p>In QGIS, the composed map layout can be exported into three formats, namely: Image, SVG and PDF.</p>
<ul>
<li>To export, click on <strong>File</strong> from the menu bar and select on of the format list below.</li>
</ul>
<p><img src="img04/image91.jpg" class="img-fluid" width="244"></p>
</section>
</section>
<section id="distance-analysis-with-vector-based-gis" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="distance-analysis-with-vector-based-gis"><span class="header-section-number">5.7</span> Distance Analysis with Vector-based GIS</h2>
<p>Distance analysis is fundamental to most GIS applications. In its simplest form, distance is a measure of how far away one thing is from another. A straight line is the shortest possible measure of the distance between two locations. In this section, you will learn how to apply distance analysis function of QGIS to determine the accessibility to pre-school from residential buildings within Punggol Planning Area.</p>
<section id="the-data" class="level3" data-number="5.7.1">
<h3 data-number="5.7.1" class="anchored" data-anchor-id="the-data"><span class="header-section-number">5.7.1</span> The data</h3>
<p>For the purpose of this study, beside Punggol Planning Subzone layer, the following data will be used:</p>
<ul>
<li><a href="https://data.gov.sg/dataset/pre-schools-location">Pre-Schools Location</a> from data.gov.sg.</li>
<li>Buildings layer of osm from <a href="https://download.geofabrik.de/asia/malaysia-singapore-brunei.html">geofabrik</a>.</li>
</ul>
</section>
<section id="preparing-pre-school-location-layer" class="level3" data-number="5.7.2">
<h3 data-number="5.7.2" class="anchored" data-anchor-id="preparing-pre-school-location-layer"><span class="header-section-number">5.7.2</span> Preparing pre-school location layer</h3>
<blockquote class="blockquote">
<p>DIY: Perform the following steps by using the steps you had learned from the previous hands-on exercise:</p>
<p>- download Pre-school Locations from data.gov.sg,</p>
<p>- place them in the newly created data.gov sub-folder, and</p>
<p>- unzip the data set and import the kml version into QGIS.</p>
</blockquote>
<p>Notice that the pre-school location layer shows all prep-school locations in Singapore. For the purpose of this study, we are going to extract pre-schools located within Punggol Planning Area.</p>
<p><img src="img04/image92.jpg" class="img-fluid" width="873"></p>
<p>Instead of using Clip operation of QGIS to extract pre-schools located with Punggol Planning Area, in this section, you will learn how to work with Spatial Query operators of QGIS.</p>
<ul>
<li>From the menu bar, select <strong>Vector</strong> -&gt; <strong>Research Tools</strong> -&gt; <strong>Select by Location</strong>.</li>
</ul>
<p><img src="img04/image93.jpg" class="img-fluid" width="893"></p>
<p>The Select by Location dialog window appears.</p>
<ul>
<li>For <em>Select features from</em>, select <code>PRESCOOLS_LOCATION</code> from the drop-down list.</li>
<li>Click on the check-box in front of <em>Intersect</em>. Students are encouraged to explore other operators.</li>
<li>For <em>By comparing to the features from</em>, select <code>MP19 Subzone</code> from the drop-down list.</li>
</ul>
<p><img src="img04/image94.jpg" class="img-fluid"></p>
<ul>
<li>When you are ready, click on <strong>Run</strong> button.</li>
</ul>
<p>When the spatial query process completed, QGIS indicates that 71 features have been selected and are highlighted on the map view similar to the screenshot below.</p>
<p><img src="img04/image95.jpg" class="img-fluid"></p>
<ul>
<li>Click on the <strong>Close</strong> button to close the dialog window.</li>
</ul>
<blockquote class="blockquote">
<p>DIY: Using the steps you had learned in previous section,</p>
<ul>
<li><p>save the selected pre-school location features into <code>Punggol Geopackage</code>. Name the data layer as <code>Pre-schools</code>. Be warn: Check the Coordinates Referencing System of the input GIS data, if necessary an appropriate Projected Coordinates System.</p></li>
<li><p>remove <code>PRESCHOOL_LOCATIONS</code> from <strong>Layers Panel</strong></p></li>
</ul>
</blockquote>
<p>Next, let us view the GIS layers in full extend.</p>
<ul>
<li>From the icon bar, click on Zoom Full <img src="img04/image96.jpg" class="img-fluid" width="23"> icon.</li>
</ul>
<p>Your screen should look similar to the screenshot below.</p>
<p><img src="img04/image97.jpg" class="img-fluid"></p>
</section>
<section id="preparing-residential-building-layer" class="level3" data-number="5.7.3">
<h3 data-number="5.7.3" class="anchored" data-anchor-id="preparing-residential-building-layer"><span class="header-section-number">5.7.3</span> Preparing residential building layer</h3>
<p>Next, we will extract the residential building layer from the building data set provided by osm.</p>
<blockquote class="blockquote">
<p>Using the steps you had learned,</p>
<ul>
<li><p>down, unzip and save the osm shapefiles into a folder called <code>shapefile</code> in the project folder.</p></li>
<li><p>import <code>gis_osm_buildings_a_free_1</code> shapefile into QGIS.</p></li>
</ul>
</blockquote>
<p>Your screen should look similar to the screenshot below.</p>
<p><img src="img04/image98.jpg" class="img-fluid"></p>
<p>The downloaded <code>gis_osm_buildings_a_free_1</code> layer covers Singapore, East Malaysia, West Malaysia (both Sabah and Sarawak states) and Brunei Darussalam. However, we are only interested on residential buildings located within Punggol Planning Area.</p>
<blockquote class="blockquote">
<p>DIY:</p>
<ul>
<li><p>Using Spatial Query function of QGIS, select buildings fall within Punggol Planning Area,</p></li>
<li><p>Export the selected buildings features into Punggol Geopackage and call it <code>Buildings</code>. Be warn: Check the Coordinates Referencing System of the input GIS data, if necessary an appropriate Projected Coordinates System.</p></li>
<li><p>Remember to remove <code>gis_osm_buildings_a_free_1</code> layer from QGIS Layers panel.</p></li>
</ul>
</blockquote>
<p>Next, let us view the GIS layers in full extend.</p>
<ul>
<li>From the icon bar, click on Zoom Full <img src="img04/image96.jpg" class="img-fluid" width="23"> icon.</li>
</ul>
<p>Your screen should look similar to the screenshot below.</p>
<p><img src="img04/image99.jpg" class="img-fluid"></p>
<p>Now, we are going to use the selection by attribute operator of QGIS to select buildings belong to <code>residential</code> type.</p>
<ul>
<li>From <strong>Layers</strong> panel, right-click on <code>Buildings</code> layer.</li>
<li>Select <strong>Open Attribute Table</strong> from the context menu.</li>
</ul>
<p>The attribute table of <code>Buildings</code> layer appears.</p>
<p><img src="img04/image100.jpg" class="img-fluid"></p>
<ul>
<li>From the menu bar of the attribute table, click on <strong>Select features using an expression</strong> icon <img src="img04/image101.jpg" width="23" height="25">.</li>
</ul>
<p>The Select by Expression dialog window appears.</p>
<p><img src="img04/image102.jpg" class="img-fluid"></p>
<ul>
<li><p>Click on the black triangle in front of <strong>Fields and Values</strong>.</p></li>
<li><p>Double click on <code>type</code>.</p></li>
<li><p>Click on <strong>=</strong> button.</p></li>
<li><p>Click on <strong>All Unique</strong> button.</p></li>
<li><p>Scroll the slider until <code>residential</code> appears.</p></li>
<li><p>Double-click on <code>residential</code>.</p></li>
</ul>
<p>The expression should look similar to the screenshot below.</p>
<p><img src="img04/image103.jpg" class="img-fluid"></p>
<p>When you are ready,</p>
<ul>
<li>Click on <strong>Select features</strong> button to run the operation.</li>
</ul>
<p>If the process completed successfully, QGIS will indicate the number of features selected at the top of the attribute table and the selected features’ records will be highlighted as shown in the screenshot below.</p>
<p><img src="img04/image104.jpg" class="img-fluid"></p>
<ul>
<li><p>Close the Selection by Expression dialog windows.</p></li>
<li><p>Close the attribute table.</p></li>
</ul>
<p>Before we continue, it is important to save the selected residential features into a new data layer in Punggol Geopackage.</p>
<blockquote class="blockquote">
<p>DIY: Using the steps you had learned, export the selected residential features into Punggol Geopackage and call it <code>Residential</code>. Be warn: Check the Coordinates Referencing System of the input GIS data, if necessary an appropriate Projected Coordinates System.</p>
</blockquote>
<ul>
<li>Switch off <code>Buildings</code> layer because they are no longer needed.</li>
</ul>
<p>Your screen should look similar to the screenshot below.</p>
<p><img src="img04/image105.jpg" class="img-fluid"></p>
</section>
<section id="deriving-centroids-of-residentail-polygon-features" class="level3" data-number="5.7.4">
<h3 data-number="5.7.4" class="anchored" data-anchor-id="deriving-centroids-of-residentail-polygon-features"><span class="header-section-number">5.7.4</span> Deriving centroids of residentail polygon features</h3>
<p>In order to calculate the distance between the residential polygon features to the pre-school point features, we need to derive the centroid of the residential polygon features first.</p>
<ul>
<li>From the menu bar, select Vector -&gt; Geomtry Tools -&gt; Centroids.</li>
</ul>
<p><img src="img04/image106.jpg" class="img-fluid"></p>
<p>The <strong>Centroids</strong> dialog window appears.</p>
<ul>
<li>For <em>Input layer</em>, select Residential from the drop-down list.</li>
</ul>
<p><img src="img04/image107.jpg" class="img-fluid"></p>
<ul>
<li>When you are ready to run the operation, click on <strong>Run</strong> button.</li>
</ul>
<p>Before you can blink your eyes the operation has done and a new layer called has been added onto Layers panel and display on View window as shown below.</p>
<p><img src="img04/image108.jpg" class="img-fluid"></p>
<ul>
<li>Close Centroids dialog window.</li>
</ul>
<p>From the screenshot above, it seems that the residential building centroids were sucessfully derived. However, if we zoom in closer you will notice that there are three centroids were located outside of the footprint of the residential buildings. Obviously, the built in Centroids function of QGIS failed to derive the centroid properly when the shape of the polygon is an odd shape.</p>
<p><img src="img04/image109.jpg" class="img-fluid"></p>
<p>The good news is that there is a QGIS plugin called <strong>realcentroid</strong> which is able to address the limitation of <strong>Centroid</strong> function.</p>
<ul>
<li>From menu bar, select <strong>Plugins</strong> -&gt; <strong>Manage and Install Plugins</strong>.</li>
</ul>
<p><img src="img04/image110.jpg" class="img-fluid" width="306"></p>
<ul>
<li>Search for <strong>realcentroid</strong> then click on <strong>Install Plugin</strong> button.</li>
</ul>
<p><img src="img04/image111.jpg" class="img-fluid"></p>
<ul>
<li>After the installation completed, click on Close button to close the dialog window.</li>
</ul>
<p>Now we are ready to use realcentroid tool to derive the centroids of building polygon features.</p>
<ul>
<li>From menu bar, select <strong>Vector</strong> -&gt; <strong>realcentroid</strong> -&gt; <strong>RealCentroid</strong>.</li>
</ul>
<p><img src="img04/image112.jpg" class="img-fluid" width="390"></p>
<p>The realcentroid dialog window appears.</p>
<ul>
<li>For <em>Polygon layer</em>, select Residential from the drop-down list.</li>
</ul>
<p><img src="img04/image113.jpg" class="img-fluid" width="270"></p>
<ul>
<li>Fro <em>Output point on surface</em> layer, click on <strong>Browse</strong> button.</li>
</ul>
<p>The Output shape file dialog window appears.</p>
<ul>
<li><p>Navigate to shapefile folder. If you have yet to create one, then go ahead to create the shapefile folder.</p></li>
<li><p>Call the output shapefile <code>residential_centroid</code>.</p></li>
</ul>
<p><img src="img04/image114.jpg" class="img-fluid"></p>
<ul>
<li>Click on <strong>Save</strong> button.</li>
</ul>
<p>The dialog window close.</p>
<ul>
<li><p>From the realcentroid dialog window, click on check box in front of <strong>Add to map canvas</strong>. This will add the newly derive layer onto Layers panel and View display when the shapefile is ready.</p></li>
<li><p>Click on <strong>OK</strong> button.</p></li>
</ul>
<p>After a few second, residential_centroid will be added on Layer panel and display on View window.</p>
<p>Notice that all the centroids are located within the residential footprint as shown below.</p>
<p><img src="img04/image115.jpg" class="img-fluid"></p>
<blockquote class="blockquote">
<p>DIY: Using the steps you had learned from previous section, save residentail_centroid shapefile into GeoPackage. Then remove centroid and residential_centroid shapefile from QGIS Layers panel.</p>
</blockquote>
</section>
<section id="computing-distance-matrix" class="level3" data-number="5.7.5">
<h3 data-number="5.7.5" class="anchored" data-anchor-id="computing-distance-matrix"><span class="header-section-number">5.7.5</span> Computing distance matrix</h3>
<p>Now we are ready to compute the distances between residential centroids and pre-school point features.</p>
<ul>
<li>From the menu bar, select <strong>Vector</strong> -&gt; <strong>Analysis Tools</strong> -&gt; <strong>Distance Matrix</strong>.</li>
</ul>
<p><img src="img04/image116.jpg" class="img-fluid"></p>
<p>The Distance Matrix dialog window appears.</p>
<ul>
<li><p>For <em>Input point layer</em>, select <code>Punggol - residential centroid</code> from the drop-down list.</p></li>
<li><p>For <em>Target point layer</em>, select <code>Pre-school</code> from the drop-down list.</p></li>
</ul>
<p><img src="img04/image117.jpg" class="img-fluid"></p>
<ul>
<li>For <em>Output matrix type</em>, select <strong>Summary distance matrix (mean, std. dev., min, max)</strong> from the drop-down list.</li>
</ul>
<p><img src="img04/image118.jpg" class="img-fluid"></p>
<blockquote class="blockquote">
<p>Note: You are encouraged to explore all the three options so that you can understand when to change to alternative output.</p>
</blockquote>
<ul>
<li>When you are ready to run the operation, click on <strong>Run</strong> button.</li>
</ul>
<p>After a few second, the process log appears on Distance Matrix indicates that the operation has completed successfully.</p>
<p><img src="img04/image119.jpg" class="img-fluid"></p>
<p>At the same time a temporarily layer called Distance matrix will be added on <strong>Layers</strong> panel and displayed on <strong>View</strong> window.</p>
<p><img src="img04/image120.jpg" class="img-fluid"></p>
<ul>
<li>At the <strong>Distance Matrix</strong> dialog window, click on <strong>Close</strong> button to close the dialog window.</li>
</ul>
<p>Let us examine the output Distance matrix layer.</p>
<ul>
<li>From <strong>Layers</strong> panel, right-click on <code>Distance matix</code> and select <strong>Open Attribute Table</strong> from the context menu.</li>
</ul>
<p>The attribute table of Distance matrix appears.</p>
<p><img src="img04/image121.jpg" class="img-fluid"></p>
<p>The attribute table consists of five columns, namely:</p>
<ul>
<li><p>InputID: the fid of the input layer (i.e.&nbsp;residential centroid)</p></li>
<li><p>MEAN: mean distance from a residential centroid to the 71 pre-schools.</p></li>
<li><p>STDEV: standard deviation of distances from a residential centroid to the 71 pre-schools.</p></li>
<li><p>MIN: minimum of distances from a residential centroid to the 71 pre-schools.</p></li>
<li><p>MAX: maximum of distances from a residential centroid to the 71 pre-schools.</p></li>
</ul>
<blockquote class="blockquote">
<p>DIY: Using the steps you had learned, save the temporarily <code>Distance matrix</code> into GeoPackage and call it <code>Dismat Residential</code>. Then, remove <code>Distance matrix</code> from Layers panel.</p>
</blockquote>
</section>
<section id="symbolosing-distance-values" class="level3" data-number="5.7.6">
<h3 data-number="5.7.6" class="anchored" data-anchor-id="symbolosing-distance-values"><span class="header-section-number">5.7.6</span> Symbolosing distance values</h3>
<p>Lastly, we are going to symbolise <code>Dismat Residential</code> layer by using appropriate statistical mapping techniques.</p>
<blockquote class="blockquote">
<p>DIY: Using the quantitative mapping you had learned in previous hands-on exercise, symbolising <code>Dismat Residential</code> layer by using values from <em>MIN</em> field.</p>
</blockquote>
<p>Your map should look similar to the screenshot below.</p>
<p><img src="img04/image122.jpg" class="img-fluid"></p>
<p>Interesting to note that despite there are four pre-schools located at the Northshore sub-zone however, there are several residential blocks have relatively poor accessibility to pre-schools. (Fruit for Thought!)</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Hands-on_Ex03.html" class="pagination-link" aria-label="GIS Mapping and Geovisualisation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">GIS Mapping and Geovisualisation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Hands-on_Ex05.html" class="pagination-link" aria-label="Trade Area Analysis with Vector-based GIS">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Trade Area Analysis with Vector-based GIS</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>